[0m01:01:30.100891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53542f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5349fcbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5337057c0>]}


============================== 01:01:30.108830 | f4ac73d0-6bbc-4ca5-ad5f-0686b39741c7 ==============================
[0m01:01:30.108830 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:01:30.110265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:30.235167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ac73d0-6bbc-4ca5-ad5f-0686b39741c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff533732400>]}
[0m01:01:30.253376 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:01:30.256359 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:01:30.257814 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.21857709, "process_user_time": 1.215882, "process_kernel_time": 0.049831, "process_mem_max_rss": "86368", "process_in_blocks": "152", "process_out_blocks": "0"}
[0m01:01:30.259001 [debug] [MainThread]: Command `dbt deps` succeeded at 01:01:30.258890 after 0.22 seconds
[0m01:01:30.259844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff53542f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5335d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5335c8130>]}
[0m01:01:30.260882 [debug] [MainThread]: Flushing usage events
[0m01:01:36.064275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b2784fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0a3d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0a3d520>]}


============================== 01:01:36.070407 | 62bf3358-6c83-4911-a3fb-f420494b8ba3 ==============================
[0m01:01:36.070407 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:01:36.071987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:36.248538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0074a30>]}
[0m01:01:36.305630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b0bd52e0>]}
[0m01:01:36.307227 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:01:36.379368 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:01:36.381816 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:01:36.382742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80aff9e250>]}
[0m01:01:37.501955 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'portfolio' in the 'models' section of file 'models/ouro/schema.yml'
[0m01:01:37.618552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ae235eb0>]}
[0m01:01:37.736414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ae145d60>]}
[0m01:01:37.737607 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:01:37.740234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ae18f070>]}
[0m01:01:37.742917 [info ] [MainThread]: 
[0m01:01:37.744300 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:01:37.750210 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:01:37.751149 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:01:37.787920 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:01:37.788423 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:01:37.789228 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:01:37.790475 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:01:37.791795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:37.793127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:37.798304 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.006 seconds
[0m01:01:37.798766 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.006 seconds
[0m01:01:37.800327 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:01:37.802004 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:01:37.804821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m01:01:37.805530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:01:37.813307 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:01:37.815819 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:01:37.816730 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:01:37.817547 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:01:37.818499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:37.819274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:37.822485 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:01:37.823416 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:01:37.824278 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:01:37.825274 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:01:37.826354 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:01:37.827233 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:01:37.830039 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:01:37.830497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:01:37.832075 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:01:37.833900 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:01:37.834819 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:01:37.835624 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:01:37.841838 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:37.842757 [debug] [MainThread]: On master: BEGIN
[0m01:01:37.843521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:37.847176 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:01:37.848018 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:37.848817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:01:37.851817 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:01:37.853320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b00bb430>]}
[0m01:01:37.854271 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:37.855108 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:37.855989 [debug] [MainThread]: On master: BEGIN
[0m01:01:37.857358 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:01:37.858309 [debug] [MainThread]: On master: COMMIT
[0m01:01:37.859149 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:37.859978 [debug] [MainThread]: On master: COMMIT
[0m01:01:37.861050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:01:37.862461 [debug] [MainThread]: On master: Close
[0m01:01:37.864576 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:01:37.865530 [info ] [MainThread]: 
[0m01:01:37.875048 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:01:37.875721 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:01:37.876829 [info ] [Thread-1  ]: 1 of 4 START sql incremental model prata.ativos ................................ [RUN]
[0m01:01:37.878419 [info ] [Thread-2  ]: 2 of 4 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:01:37.879727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.ativos)
[0m01:01:37.880919 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.indicadores)
[0m01:01:37.881872 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:01:37.882995 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:01:37.895518 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:01:37.899307 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:01:37.908340 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:01:37.915596 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:01:37.994001 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:37.994695 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:37.995862 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp010137950259"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo
FROM ativos_limpos
  );
  
  
[0m01:01:37.996955 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp010137954216"
  
  
    as
  
  (
    


WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo,
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT 
    data,
    ativo,
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:01:37.997905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:37.998800 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:38.005791 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.008 seconds
[0m01:01:38.020939 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.022116 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:01:38.023662 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:38.024639 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.025514 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ativos__dbt_tmp010137950259'
        
      order by ordinal_position

  
[0m01:01:38.027682 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.029 seconds
[0m01:01:38.063633 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.037 seconds
[0m01:01:38.065672 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.072492 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.073614 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:01:38.074837 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.076172 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:38.077394 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.078537 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'indicadores__dbt_tmp010137954216'
        
      order by ordinal_position

  
[0m01:01:38.079427 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m01:01:38.081579 [debug] [Thread-1  ]: Changing col type from character varying(10) to character varying(256) in table database: "dw_nerds_prd"
schema: "prata"
identifier: "ativos"

[0m01:01:38.089274 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.089749 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.010 seconds
[0m01:01:38.090644 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    alter table "dw_nerds_prd"."prata"."ativos" add column "ativo__dbt_alter" character varying(256);
    update "dw_nerds_prd"."prata"."ativos" set "ativo__dbt_alter" = "ativo";
    alter table "dw_nerds_prd"."prata"."ativos" drop column "ativo" cascade;
    alter table "dw_nerds_prd"."prata"."ativos" rename column "ativo__dbt_alter" to "ativo"
  
[0m01:01:38.094211 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.095851 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.098233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:01:38.105628 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.106163 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.009 seconds
[0m01:01:38.107017 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.108876 [debug] [Thread-2  ]: Changing col type from character varying(10) to character varying(256) in table database: "dw_nerds_prd"
schema: "prata"
identifier: "indicadores"

[0m01:01:38.112008 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.112421 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m01:01:38.113299 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    alter table "dw_nerds_prd"."prata"."indicadores" add column "ativo__dbt_alter" character varying(256);
    update "dw_nerds_prd"."prata"."indicadores" set "ativo__dbt_alter" = "ativo";
    alter table "dw_nerds_prd"."prata"."indicadores" drop column "ativo" cascade;
    alter table "dw_nerds_prd"."prata"."indicadores" rename column "ativo__dbt_alter" to "ativo"
  
[0m01:01:38.124040 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:01:38.126455 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:38.127926 [debug] [Thread-2  ]: Changing col type from character varying(50) to character varying(256) in table database: "dw_nerds_prd"
schema: "prata"
identifier: "indicadores"

[0m01:01:38.131159 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.132091 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    alter table "dw_nerds_prd"."prata"."indicadores" add column "indicador__dbt_alter" character varying(256);
    update "dw_nerds_prd"."prata"."indicadores" set "indicador__dbt_alter" = "indicador";
    alter table "dw_nerds_prd"."prata"."indicadores" drop column "indicador" cascade;
    alter table "dw_nerds_prd"."prata"."indicadores" rename column "indicador__dbt_alter" to "indicador"
  
[0m01:01:38.136195 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:01:38.140638 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.141758 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.142398 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.143995 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      insert into "dw_nerds_prd"."prata"."ativos" ("data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo")
    (
        select "data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo"
        from "ativos__dbt_tmp010137950259"
    )


  
[0m01:01:38.145602 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:01:38.146341 [debug] [Thread-1  ]: SQL status: INSERT 0 600 in 0.001 seconds
[0m01:01:38.149260 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:01:38.164824 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:01:38.166859 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:38.168410 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:01:38.171572 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:01:38.172170 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.174703 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:01:38.175897 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      insert into "dw_nerds_prd"."prata"."indicadores" ("data", "valor_indicador", "ativo", "indicador")
    (
        select "data", "valor_indicador", "ativo", "indicador"
        from "indicadores__dbt_tmp010137954216"
    )


  
[0m01:01:38.178536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80acd7ce50>]}
[0m01:01:38.180592 [info ] [Thread-1  ]: 1 of 4 OK created sql incremental model prata.ativos ........................... [[32mINSERT 0 600[0m in 0.30s]
[0m01:01:38.182240 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:01:38.183472 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:01:38.184526 [info ] [Thread-1  ]: 3 of 4 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:01:38.185633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:01:38.186521 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:01:38.190678 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:01:38.196803 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:01:38.197504 [debug] [Thread-2  ]: SQL status: INSERT 0 27614 in 0.018 seconds
[0m01:01:38.206490 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.209092 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:01:38.210850 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp010138200892"
  
  
    as
  
  (
    


WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:01:38.212354 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:38.213634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:38.215237 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:01:38.225056 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m01:01:38.227098 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:01:38.228702 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80acd7c940>]}
[0m01:01:38.230374 [info ] [Thread-2  ]: 2 of 4 OK created sql incremental model prata.indicadores ...................... [[32mINSERT 0 27614[0m in 0.35s]
[0m01:01:38.232100 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:01:38.234068 [debug] [Thread-1  ]: SQL status: SELECT 12126 in 0.020 seconds
[0m01:01:38.241235 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.242655 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:01:38.244131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:38.245206 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.246332 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp010138200892'
        
      order by ordinal_position

  
[0m01:01:38.251489 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:01:38.255406 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.256418 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.259204 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:01:38.263322 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.264668 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:38.267349 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:01:38.269803 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:01:38.274872 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.275863 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp010138200892"
    )


  
[0m01:01:38.293537 [debug] [Thread-1  ]: SQL status: INSERT 0 12126 in 0.017 seconds
[0m01:01:38.295701 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:01:38.297256 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:38.299354 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:01:38.302019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:01:38.303520 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:01:38.304817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b16a81f0>]}
[0m01:01:38.306018 [info ] [Thread-1  ]: 3 of 4 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 12126[0m in 0.12s]
[0m01:01:38.307358 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:01:38.309219 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:38.310477 [info ] [Thread-2  ]: 4 of 4 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m01:01:38.311843 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.indicadores, now model.financas_data_pipeline.produto_dados_financeiros)
[0m01:01:38.312937 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:38.322990 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.334563 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:38.348447 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.357379 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.358703 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m01:01:38.360116 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:38.363708 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m01:01:38.364760 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.365632 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m01:01:38.375103 [debug] [Thread-2  ]: SQL status: SELECT 600 in 0.009 seconds
[0m01:01:38.382454 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.383743 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m01:01:38.384909 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:01:38.392613 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:01:38.394266 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.395674 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:01:38.398157 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m01:01:38.405518 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m01:01:38.410479 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:01:38.411484 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m01:01:38.412690 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:01:38.415394 [debug] [Thread-2  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m01:01:38.416685 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62bf3358-6c83-4911-a3fb-f420494b8ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b16a81f0>]}
[0m01:01:38.417925 [info ] [Thread-2  ]: 4 of 4 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.11s]
[0m01:01:38.419052 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:38.420935 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:38.421778 [debug] [MainThread]: On master: BEGIN
[0m01:01:38.422561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:38.425550 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:01:38.426485 [debug] [MainThread]: On master: COMMIT
[0m01:01:38.427380 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:38.428174 [debug] [MainThread]: On master: COMMIT
[0m01:01:38.429140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:01:38.429933 [debug] [MainThread]: On master: Close
[0m01:01:38.431044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:38.432074 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:01:38.433014 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m01:01:38.434137 [info ] [MainThread]: 
[0m01:01:38.435372 [info ] [MainThread]: Finished running 3 incremental models, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m01:01:38.437677 [debug] [MainThread]: Command end result
[0m01:01:38.484100 [info ] [MainThread]: 
[0m01:01:38.485252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:38.486210 [info ] [MainThread]: 
[0m01:01:38.487302 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:01:38.489185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.485552, "process_user_time": 3.011669, "process_kernel_time": 0.168971, "process_mem_max_rss": "114268", "process_in_blocks": "6072", "process_out_blocks": "0"}
[0m01:01:38.490525 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:38.490372 after 2.49 seconds
[0m01:01:38.491593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b2784fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b2225d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b10eab20>]}
[0m01:01:38.492491 [debug] [MainThread]: Flushing usage events
[0m01:01:53.985215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f0446100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ee6f3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ee6f35e0>]}


============================== 01:01:53.993897 | d75fb934-a455-4414-aeec-b82b2e341351 ==============================
[0m01:01:53.993897 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:01:53.995042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:01:54.159701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f005a9d0>]}
[0m01:01:54.209394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3edc9f040>]}
[0m01:01:54.211119 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:01:54.282020 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:01:54.501295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:01:54.502476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:01:54.540392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ed932130>]}
[0m01:01:54.653466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ed8875b0>]}
[0m01:01:54.654626 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:01:54.656059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ed932a60>]}
[0m01:01:54.658914 [info ] [MainThread]: 
[0m01:01:54.660517 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:01:54.665436 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:01:54.666157 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:01:54.732093 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:01:54.732565 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:01:54.733653 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:01:54.734689 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:01:54.735527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:54.736335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:54.740302 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m01:01:54.740711 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m01:01:54.742146 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:01:54.743845 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:01:54.746786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m01:01:54.747502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:01:54.754103 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:01:54.756861 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:01:54.757928 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:01:54.758918 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:01:54.759841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:54.760800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:54.764369 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:01:54.765473 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:01:54.766216 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:01:54.767032 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:01:54.767907 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:01:54.768848 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:01:54.771649 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:01:54.772021 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:01:54.773734 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:01:54.775434 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:01:54.776611 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:01:54.777568 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:01:54.784227 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:54.785157 [debug] [MainThread]: On master: BEGIN
[0m01:01:54.785978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:54.790823 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:01:54.791971 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:54.792990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:01:54.796530 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:01:54.798257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ed887a60>]}
[0m01:01:54.799131 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:54.800080 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:54.800883 [debug] [MainThread]: On master: BEGIN
[0m01:01:54.801847 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:01:54.802659 [debug] [MainThread]: On master: COMMIT
[0m01:01:54.803570 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:54.804405 [debug] [MainThread]: On master: COMMIT
[0m01:01:54.805258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:01:54.806721 [debug] [MainThread]: On master: Close
[0m01:01:54.808440 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:01:54.809486 [info ] [MainThread]: 
[0m01:01:54.816289 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:01:54.816776 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:01:54.817687 [info ] [Thread-1  ]: 1 of 4 START sql incremental model prata.ativos ................................ [RUN]
[0m01:01:54.819104 [info ] [Thread-2  ]: 2 of 4 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:01:54.820532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.ativos)
[0m01:01:54.821666 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.indicadores)
[0m01:01:54.822771 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:01:54.823739 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:01:54.833415 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:01:54.837259 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:01:54.841606 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:01:54.842433 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:01:54.925664 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:54.927542 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:54.928569 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp010154883313"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo
FROM ativos_limpos
  );
  
  
[0m01:01:54.929590 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp010154880000"
  
  
    as
  
  (
    


WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo,
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT 
    data,
    ativo,
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:01:54.931435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:54.933618 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:01:54.940826 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.009 seconds
[0m01:01:54.959409 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:54.961035 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:01:54.962898 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:54.963755 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:54.964650 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ativos__dbt_tmp010154883313'
        
      order by ordinal_position

  
[0m01:01:54.966898 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.033 seconds
[0m01:01:54.970306 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:54.970758 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.005 seconds
[0m01:01:54.971411 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:01:54.977863 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:54.978933 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:54.979668 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:54.980543 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:54.981894 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'indicadores__dbt_tmp010154880000'
        
      order by ordinal_position

  
[0m01:01:54.983346 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:01:54.991747 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.009 seconds
[0m01:01:54.992510 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:54.996624 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:54.997718 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:54.998668 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:55.001327 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:01:55.002086 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:01:55.012838 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:01:55.017241 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:55.020245 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:55.023000 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:01:55.025174 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:01:55.026337 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:55.027339 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      insert into "dw_nerds_prd"."prata"."ativos" ("data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo")
    (
        select "data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo"
        from "ativos__dbt_tmp010154883313"
    )


  
[0m01:01:55.029510 [debug] [Thread-1  ]: SQL status: INSERT 0 600 in 0.001 seconds
[0m01:01:55.030079 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:55.045023 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:01:55.046017 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      insert into "dw_nerds_prd"."prata"."indicadores" ("data", "valor_indicador", "ativo", "indicador")
    (
        select "data", "valor_indicador", "ativo", "indicador"
        from "indicadores__dbt_tmp010154880000"
    )


  
[0m01:01:55.047135 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:01:55.048733 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:01:55.050924 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:01:55.053323 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:01:55.055489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f0088280>]}
[0m01:01:55.056914 [info ] [Thread-1  ]: 1 of 4 OK created sql incremental model prata.ativos ........................... [[32mINSERT 0 600[0m in 0.23s]
[0m01:01:55.058151 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:01:55.059127 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:01:55.060139 [info ] [Thread-1  ]: 3 of 4 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:01:55.061203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:01:55.062226 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:01:55.065976 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:01:55.066454 [debug] [Thread-2  ]: SQL status: INSERT 0 27614 in 0.018 seconds
[0m01:01:55.070572 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:01:55.071652 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:01:55.072605 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:01:55.074677 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:01:55.079996 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.080497 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m01:01:55.081263 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp010155078430"
  
  
    as
  
  (
    


WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:01:55.082581 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:01:55.083448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:01:55.084694 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ec4ead30>]}
[0m01:01:55.086776 [info ] [Thread-2  ]: 2 of 4 OK created sql incremental model prata.indicadores ...................... [[32mINSERT 0 27614[0m in 0.26s]
[0m01:01:55.088384 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:01:55.097682 [debug] [Thread-1  ]: SQL status: SELECT 12126 in 0.014 seconds
[0m01:01:55.102194 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.103317 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:01:55.104580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:01:55.105526 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.106434 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp010155078430'
        
      order by ordinal_position

  
[0m01:01:55.111911 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.005 seconds
[0m01:01:55.115828 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.116819 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:55.119655 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:01:55.124508 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.125645 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:01:55.128145 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:01:55.130570 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:01:55.135632 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:01:55.136496 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp010155078430"
    )


  
[0m01:01:55.138177 [debug] [Thread-1  ]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "tesouro_pkey"
DETAIL:  Key (data)=(2024-12-05) already exists.

[0m01:01:55.139148 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: ROLLBACK
[0m01:01:55.140423 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:01:55.152532 [debug] [Thread-1  ]: Database Error in model tesouro (models/prata/tesouro.sql)
  duplicate key value violates unique constraint "tesouro_pkey"
  DETAIL:  Key (data)=(2024-12-05) already exists.
  compiled code at target/run/financas_data_pipeline/models/prata/tesouro.sql
[0m01:01:55.153778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd75fb934-a455-4414-aeec-b82b2e341351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ec486310>]}
[0m01:01:55.155039 [error] [Thread-1  ]: 3 of 4 ERROR creating sql incremental model prata.tesouro ...................... [[31mERROR[0m in 0.09s]
[0m01:01:55.156198 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:01:55.157800 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:55.158734 [info ] [Thread-2  ]: 4 of 4 SKIP relation ouro.produto_dados_financeiros ............................ [[33mSKIP[0m]
[0m01:01:55.159749 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:01:55.161452 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:55.162283 [debug] [MainThread]: On master: BEGIN
[0m01:01:55.163058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:55.166188 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:01:55.167003 [debug] [MainThread]: On master: COMMIT
[0m01:01:55.167905 [debug] [MainThread]: Using ***** connection "master"
[0m01:01:55.168666 [debug] [MainThread]: On master: COMMIT
[0m01:01:55.169561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:01:55.170422 [debug] [MainThread]: On master: Close
[0m01:01:55.171444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:55.172284 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:01:55.173208 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:01:55.174262 [info ] [MainThread]: 
[0m01:01:55.175455 [info ] [MainThread]: Finished running 3 incremental models, 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m01:01:55.177383 [debug] [MainThread]: Command end result
[0m01:01:55.224567 [info ] [MainThread]: 
[0m01:01:55.225792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:01:55.226899 [info ] [MainThread]: 
[0m01:01:55.228073 [error] [MainThread]:   Database Error in model tesouro (models/prata/tesouro.sql)
  duplicate key value violates unique constraint "tesouro_pkey"
  DETAIL:  Key (data)=(2024-12-05) already exists.
  compiled code at target/run/financas_data_pipeline/models/prata/tesouro.sql
[0m01:01:55.229258 [info ] [MainThread]: 
[0m01:01:55.230288 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m01:01:55.231997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.309292, "process_user_time": 2.021013, "process_kernel_time": 0.089601, "process_mem_max_rss": "107800", "process_in_blocks": "328", "command_success": false, "process_out_blocks": "0"}
[0m01:01:55.233179 [debug] [MainThread]: Command `dbt run` failed at 01:01:55.233052 after 1.31 seconds
[0m01:01:55.234271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f0446100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eee0e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3f005a9d0>]}
[0m01:01:55.235339 [debug] [MainThread]: Flushing usage events
[0m01:15:18.469699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615e75c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615ca095b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615ca09550>]}


============================== 01:15:18.477270 | 21391c6a-32ea-445c-85a1-39044194d131 ==============================
[0m01:15:18.477270 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:15:18.479139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:18.474362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee305b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee1309520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee13094c0>]}


============================== 01:15:18.482475 | 51af11c0-25df-4944-9fae-438e8b5b7cb6 ==============================
[0m01:15:18.482475 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:15:18.483436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:15:18.709715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615e370c10>]}
[0m01:15:18.709715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee12eb250>]}
[0m01:15:18.761767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee1319a30>]}
[0m01:15:18.763387 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:15:18.766024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615d0b6280>]}
[0m01:15:18.767402 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:15:18.843495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:15:18.844173 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:15:19.087155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:15:19.087158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:15:19.088578 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:15:19.088600 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:15:19.089456 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/tesouro.sql
[0m01:15:19.089497 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:15:19.090679 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/tesouro.sql
[0m01:15:19.090601 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:15:19.357697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee0397130>]}
[0m01:15:19.357605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615ba98130>]}
[0m01:15:19.527793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee051e3a0>]}
[0m01:15:19.528190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615ba66a90>]}
[0m01:15:19.529050 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:15:19.529426 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:15:19.529956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee0865460>]}
[0m01:15:19.530410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615bb76790>]}
[0m01:15:19.532101 [info ] [MainThread]: 
[0m01:15:19.532273 [info ] [MainThread]: 
[0m01:15:19.533307 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:15:19.533320 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:15:19.534964 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:15:19.538442 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:15:19.571458 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:15:19.571419 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:15:19.572510 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:15:19.572518 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:15:19.573320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:19.573322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:19.578351 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m01:15:19.578334 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m01:15:19.580101 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:15:19.580184 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:15:19.582315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:15:19.585955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:15:19.583228 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:15:19.586706 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:15:19.589965 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:15:19.593338 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:15:19.594193 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:15:19.595175 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:15:19.593366 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:15:19.596368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:19.596604 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:15:19.597247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:19.597532 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:15:19.598604 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:15:19.599641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:19.600891 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.600600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:19.601798 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:15:19.602264 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m01:15:19.603108 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:15:19.604053 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.604104 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:15:19.605562 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:15:19.604711 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.605385 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:15:19.607022 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:15:19.606577 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:15:19.607727 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:15:19.608768 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:15:19.608780 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:15:19.609161 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m01:15:19.610081 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:15:19.611789 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:15:19.611600 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:15:19.613990 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:15:19.612389 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m01:15:19.614183 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:15:19.616725 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:15:19.618451 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:15:19.620849 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.620500 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:15:19.622207 [debug] [MainThread]: On master: BEGIN
[0m01:15:19.623484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:19.627313 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.628444 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.628533 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.629524 [debug] [MainThread]: On master: BEGIN
[0m01:15:19.629602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:15:19.630512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:19.633727 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:15:19.634816 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.636012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615ba66be0>]}
[0m01:15:19.636278 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.637176 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:19.637309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:15:19.638367 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.639254 [debug] [MainThread]: On master: BEGIN
[0m01:15:19.640456 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:15:19.641515 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.641408 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:15:19.642506 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.643556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee051e460>]}
[0m01:15:19.643512 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.644793 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:19.644890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:19.646198 [debug] [MainThread]: On master: Close
[0m01:15:19.646125 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.647400 [debug] [MainThread]: On master: BEGIN
[0m01:15:19.647530 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:15:19.648559 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:15:19.648593 [info ] [MainThread]: 
[0m01:15:19.649396 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.650360 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.651311 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.652257 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:19.653065 [debug] [MainThread]: On master: Close
[0m01:15:19.654059 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:15:19.655046 [info ] [MainThread]: 
[0m01:15:19.656506 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:15:19.657078 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:15:19.658099 [info ] [Thread-1  ]: 1 of 3 START sql incremental model prata.ativos ................................ [RUN]
[0m01:15:19.659107 [info ] [Thread-2  ]: 2 of 3 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:15:19.660191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:15:19.661420 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:15:19.663328 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:15:19.662538 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:15:19.664512 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m01:15:19.665572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.produto_dados_financeiros)
[0m01:15:19.666439 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m01:15:19.663446 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:15:19.676644 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.675770 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:15:19.679979 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:15:19.681284 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m01:15:19.683355 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:15:19.684029 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:15:19.723129 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.729330 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.730555 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m01:15:19.731650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:19.735639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m01:15:19.736727 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.737820 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m01:15:19.742441 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m01:15:19.749548 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.750900 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m01:15:19.752447 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:15:19.769657 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:15:19.770681 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.771585 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:15:19.773157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:15:19.773850 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.775534 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:19.776569 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp011519721069"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
    
      AND (data, ticker) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."ativos")
    
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo
FROM ativos_limpos
  );
  
  
[0m01:15:19.777760 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp011519726451"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo,
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND (data, ticker) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."indicadores")
    
)

SELECT 
    data,
    ativo,
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:15:19.778687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:19.779686 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:15:19.784513 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m01:15:19.786679 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.008 seconds
[0m01:15:19.790036 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:15:19.791019 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m01:15:19.792152 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:15:19.795455 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m01:15:19.798189 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51af11c0-25df-4944-9fae-438e8b5b7cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee2cc58b0>]}
[0m01:15:19.799960 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 0[0m in 0.13s]
[0m01:15:19.801057 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:15:19.801912 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.802918 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.802929 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:15:19.803705 [debug] [MainThread]: On master: BEGIN
[0m01:15:19.804089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:15:19.804475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:19.804914 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.805788 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ativos__dbt_tmp011519721069'
        
      order by ordinal_position

  
[0m01:15:19.807548 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:15:19.808393 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.809173 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:19.810150 [debug] [MainThread]: On master: COMMIT
[0m01:15:19.811167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:19.811952 [debug] [MainThread]: On master: Close
[0m01:15:19.812868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:19.812246 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.005 seconds
[0m01:15:19.813622 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m01:15:19.814326 [debug] [MainThread]: Connection 'list_dw_nerds_prd_prata' was properly closed.
[0m01:15:19.815031 [info ] [MainThread]: 
[0m01:15:19.815910 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m01:15:19.816994 [debug] [MainThread]: Command end result
[0m01:15:19.822248 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.823241 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.826243 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:15:19.834677 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.835718 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.838279 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:15:19.855191 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:15:19.858687 [info ] [MainThread]: 
[0m01:15:19.859900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:15:19.860983 [info ] [MainThread]: 
[0m01:15:19.861726 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:15:19.861874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:15:19.862920 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      
        
            delete from "dw_nerds_prd"."prata"."ativos"
            where (
                data,ticker) in (
                select (data,ticker)
                from "ativos__dbt_tmp011519721069"
            );

        
    

    insert into "dw_nerds_prd"."prata"."ativos" ("data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo")
    (
        select "data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo"
        from "ativos__dbt_tmp011519721069"
    )
  
[0m01:15:19.863719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4668182, "process_user_time": 2.287019, "process_kernel_time": 0.153835, "process_mem_max_rss": "263340", "process_in_blocks": "31024", "process_out_blocks": "0"}
[0m01:15:19.864424 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "ticker" does not exist
LINE 8:                 select (data,ticker)
                                     ^

[0m01:15:19.864683 [debug] [MainThread]: Command `dbt run` succeeded at 01:15:19.864577 after 1.47 seconds
[0m01:15:19.865385 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: ROLLBACK
[0m01:15:19.865451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee305b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee1a24b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edeff77f0>]}
[0m01:15:19.866521 [debug] [MainThread]: Flushing usage events
[0m01:15:19.866729 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:15:19.872157 [debug] [Thread-1  ]: Database Error in model ativos (models/prata/ativos.sql)
  column "ticker" does not exist
  LINE 8:                 select (data,ticker)
                                       ^
  compiled code at target/run/financas_data_pipeline/models/prata/ativos.sql
[0m01:15:19.874208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615a6d53d0>]}
[0m01:15:19.875316 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model prata.ativos ....................... [[31mERROR[0m in 0.21s]
[0m01:15:19.876631 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:15:19.877554 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:15:19.878445 [info ] [Thread-1  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:15:19.879287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:15:19.880032 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:15:19.884761 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:15:19.890908 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:15:19.897171 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.898428 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp011519895258"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:15:19.899404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:15:19.905565 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m01:15:19.909436 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.910440 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:15:19.911486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:15:19.912457 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.913274 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp011519895258'
        
      order by ordinal_position

  
[0m01:15:19.918093 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:15:19.921766 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.922680 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.925186 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:15:19.928659 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.929459 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.931837 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:15:19.935049 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:15:19.941580 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.942601 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp011519895258"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp011519895258"
    )
  
[0m01:15:19.944039 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.000 seconds
[0m01:15:19.959945 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:15:19.960497 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.181 seconds
[0m01:15:19.961302 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:15:19.964904 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:19.966022 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:15:19.966833 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:15:19.968196 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m01:15:19.968574 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:15:19.969223 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:19.971508 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:15:19.972426 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'indicadores__dbt_tmp011519726451'
        
      order by ordinal_position

  
[0m01:15:19.973521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615af40e80>]}
[0m01:15:19.974813 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.09s]
[0m01:15:19.975876 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:15:19.978093 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.004 seconds
[0m01:15:19.981877 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:19.982750 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.985423 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:15:19.988965 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:19.989713 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:15:19.991979 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.001 seconds
[0m01:15:19.995112 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:15:20.000801 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:15:20.001637 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      
        
            delete from "dw_nerds_prd"."prata"."indicadores"
            where (
                data,ticker) in (
                select (data,ticker)
                from "indicadores__dbt_tmp011519726451"
            );

        
    

    insert into "dw_nerds_prd"."prata"."indicadores" ("data", "valor_indicador", "ativo", "indicador")
    (
        select "data", "valor_indicador", "ativo", "indicador"
        from "indicadores__dbt_tmp011519726451"
    )
  
[0m01:15:20.003493 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "ticker" does not exist
LINE 8:                 select (data,ticker)
                                     ^

[0m01:15:20.004672 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: ROLLBACK
[0m01:15:20.005875 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:15:20.007299 [debug] [Thread-2  ]: Database Error in model indicadores (models/prata/indicadores.sql)
  column "ticker" does not exist
  LINE 8:                 select (data,ticker)
                                       ^
  compiled code at target/run/financas_data_pipeline/models/prata/indicadores.sql
[0m01:15:20.008186 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21391c6a-32ea-445c-85a1-39044194d131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6158e8dd90>]}
[0m01:15:20.009424 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model prata.indicadores .................. [[31mERROR[0m in 0.35s]
[0m01:15:20.010547 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:15:20.012457 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:20.013330 [debug] [MainThread]: On master: BEGIN
[0m01:15:20.014016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:20.017073 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:15:20.017812 [debug] [MainThread]: On master: COMMIT
[0m01:15:20.018534 [debug] [MainThread]: Using ***** connection "master"
[0m01:15:20.019208 [debug] [MainThread]: On master: COMMIT
[0m01:15:20.019994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:20.020685 [debug] [MainThread]: On master: Close
[0m01:15:20.021463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:20.022184 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:15:20.022967 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:15:20.023735 [info ] [MainThread]: 
[0m01:15:20.024616 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m01:15:20.025896 [debug] [MainThread]: Command end result
[0m01:15:20.071614 [info ] [MainThread]: 
[0m01:15:20.072772 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:15:20.073626 [info ] [MainThread]: 
[0m01:15:20.074774 [error] [MainThread]:   Database Error in model ativos (models/prata/ativos.sql)
  column "ticker" does not exist
  LINE 8:                 select (data,ticker)
                                       ^
  compiled code at target/run/financas_data_pipeline/models/prata/ativos.sql
[0m01:15:20.075883 [info ] [MainThread]: 
[0m01:15:20.076977 [error] [MainThread]:   Database Error in model indicadores (models/prata/indicadores.sql)
  column "ticker" does not exist
  LINE 8:                 select (data,ticker)
                                       ^
  compiled code at target/run/financas_data_pipeline/models/prata/indicadores.sql
[0m01:15:20.077685 [info ] [MainThread]: 
[0m01:15:20.078509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:15:20.079839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6835848, "process_user_time": 2.506165, "process_kernel_time": 0.099847, "process_mem_max_rss": "263340", "process_in_blocks": "18336", "command_success": false, "process_out_blocks": "0"}
[0m01:15:20.082886 [debug] [MainThread]: Command `dbt run` failed at 01:15:20.082728 after 1.69 seconds
[0m01:15:20.083906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615e75c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615e240520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615d0b63d0>]}
[0m01:15:20.084948 [debug] [MainThread]: Flushing usage events
[0m01:19:24.199876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5048358100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5046606670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5046606610>]}


============================== 01:19:24.206782 | 0ebef987-af2c-481b-ae71-602320f84d5a ==============================
[0m01:19:24.206782 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:19:24.207844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:19:24.436471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5045c5bdc0>]}
[0m01:19:24.490813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50472844f0>]}
[0m01:19:24.492481 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:19:24.564648 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:19:24.819955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:19:24.821447 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:19:24.822600 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:19:25.087500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5045689a00>]}
[0m01:19:25.247536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f504588b760>]}
[0m01:19:25.248937 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:19:25.250217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5047e98100>]}
[0m01:19:25.252557 [info ] [MainThread]: 
[0m01:19:25.254398 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:19:25.260189 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:19:25.295801 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:19:25.296935 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:19:25.297728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:25.302319 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.005 seconds
[0m01:19:25.303979 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:19:25.305904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m01:19:25.306600 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m01:19:25.312715 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:19:25.315352 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:19:25.316344 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:19:25.317109 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:19:25.317935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:25.318743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:25.321921 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:19:25.322604 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:19:25.323378 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:19:25.324248 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:19:25.325023 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:19:25.325875 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:19:25.328388 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:19:25.328817 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:19:25.330256 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:19:25.331853 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:19:25.332783 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:19:25.333465 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:19:25.340450 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.341711 [debug] [MainThread]: On master: BEGIN
[0m01:19:25.342544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:25.346193 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:19:25.347393 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.348281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:19:25.350947 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:19:25.352412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f504588b8b0>]}
[0m01:19:25.353206 [debug] [MainThread]: On master: ROLLBACK
[0m01:19:25.353962 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.354681 [debug] [MainThread]: On master: BEGIN
[0m01:19:25.355710 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:19:25.356491 [debug] [MainThread]: On master: COMMIT
[0m01:19:25.357265 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.357952 [debug] [MainThread]: On master: COMMIT
[0m01:19:25.358743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:19:25.359477 [debug] [MainThread]: On master: Close
[0m01:19:25.360335 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:19:25.361123 [info ] [MainThread]: 
[0m01:19:25.367960 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:19:25.368377 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:19:25.369156 [info ] [Thread-1  ]: 1 of 3 START sql incremental model prata.ativos ................................ [RUN]
[0m01:19:25.370174 [info ] [Thread-2  ]: 2 of 3 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:19:25.371242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.ativos)
[0m01:19:25.372518 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.indicadores)
[0m01:19:25.373422 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:19:25.374306 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:19:25.385265 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:19:25.389258 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:19:25.392716 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:19:25.393274 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:19:25.472922 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.473496 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.474410 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp011925431876"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
    
      AND (data, ticker) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."ativos")
    
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo
FROM ativos_limpos
  );
  
  
[0m01:19:25.475626 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp011925430339"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo,
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND (data, ticker) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."indicadores")
    
)

SELECT 
    data,
    ativo,
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:19:25.476518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:25.477314 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:19:25.484882 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.008 seconds
[0m01:19:25.501053 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.502419 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:19:25.503475 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:19:25.504227 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.505219 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'ativos__dbt_tmp011925431876'
        
      order by ordinal_position

  
[0m01:19:25.509907 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.004 seconds
[0m01:19:25.515468 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.516401 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.519398 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:19:25.527850 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.528950 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'ativos'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.531557 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.002 seconds
[0m01:19:25.547829 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:19:25.553404 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:19:25.554321 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

      
        
            delete from "dw_nerds_prd"."prata"."ativos"
            where (
                data,ativo) in (
                select (data,ativo)
                from "ativos__dbt_tmp011925431876"
            );

        
    

    insert into "dw_nerds_prd"."prata"."ativos" ("data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo")
    (
        select "data", "preco_abertura", "preco_alto", "preco_baixo", "preco_fechamento", "volume_negociado", "ativo"
        from "ativos__dbt_tmp011925431876"
    )
  
[0m01:19:25.555920 [debug] [Thread-1  ]: Postgres adapter: Postgres error: subquery has too few columns
LINE 7:                 data,ativo) in (
                                    ^

[0m01:19:25.557123 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: ROLLBACK
[0m01:19:25.558524 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:19:25.565603 [debug] [Thread-1  ]: Database Error in model ativos (models/prata/ativos.sql)
  subquery has too few columns
  LINE 7:                 data,ativo) in (
                                      ^
  compiled code at target/run/financas_data_pipeline/models/prata/ativos.sql
[0m01:19:25.568321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f504427a5e0>]}
[0m01:19:25.569714 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model prata.ativos ....................... [[31mERROR[0m in 0.20s]
[0m01:19:25.570905 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:19:25.571822 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:19:25.573210 [info ] [Thread-1  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:19:25.575814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:19:25.576744 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:19:25.581401 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:19:25.586586 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:19:25.593800 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.595075 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp011925590299"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:19:25.596482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:19:25.602367 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m01:19:25.606236 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.607166 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:19:25.608246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:19:25.609124 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.610000 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp011925590299'
        
      order by ordinal_position

  
[0m01:19:25.614455 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:19:25.618152 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.619111 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.621847 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:19:25.625865 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.626847 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.629093 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.001 seconds
[0m01:19:25.631194 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:19:25.631643 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.154 seconds
[0m01:19:25.635271 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.636158 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:19:25.637422 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m01:19:25.638712 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.639559 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.641556 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'indicadores__dbt_tmp011925430339'
        
      order by ordinal_position

  
[0m01:19:25.642490 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp011925590299"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp011925590299"
    )
  
[0m01:19:25.644593 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m01:19:25.652699 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.009 seconds
[0m01:19:25.660472 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:19:25.663909 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.665482 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:19:25.666696 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.667604 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:19:25.669685 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:19:25.670560 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:19:25.672447 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:19:25.676178 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.677409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50457e53a0>]}
[0m01:19:25.678079 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'indicadores'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:19:25.679187 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.10s]
[0m01:19:25.680828 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:19:25.682419 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.002 seconds
[0m01:19:25.684909 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:19:25.689803 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:19:25.690789 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

      
        
            delete from "dw_nerds_prd"."prata"."indicadores"
            where (
                data,ativo) in (
                select (data,ativo)
                from "indicadores__dbt_tmp011925430339"
            );

        
    

    insert into "dw_nerds_prd"."prata"."indicadores" ("data", "valor_indicador", "ativo", "indicador")
    (
        select "data", "valor_indicador", "ativo", "indicador"
        from "indicadores__dbt_tmp011925430339"
    )
  
[0m01:19:25.692465 [debug] [Thread-2  ]: Postgres adapter: Postgres error: subquery has too few columns
LINE 7:                 data,ativo) in (
                                    ^

[0m01:19:25.693504 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: ROLLBACK
[0m01:19:25.694689 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:19:25.696235 [debug] [Thread-2  ]: Database Error in model indicadores (models/prata/indicadores.sql)
  subquery has too few columns
  LINE 7:                 data,ativo) in (
                                      ^
  compiled code at target/run/financas_data_pipeline/models/prata/indicadores.sql
[0m01:19:25.697268 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ebef987-af2c-481b-ae71-602320f84d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50442dc040>]}
[0m01:19:25.698456 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model prata.indicadores .................. [[31mERROR[0m in 0.32s]
[0m01:19:25.699554 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:19:25.701565 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.702424 [debug] [MainThread]: On master: BEGIN
[0m01:19:25.703255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:25.706865 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:19:25.707737 [debug] [MainThread]: On master: COMMIT
[0m01:19:25.708546 [debug] [MainThread]: Using ***** connection "master"
[0m01:19:25.709325 [debug] [MainThread]: On master: COMMIT
[0m01:19:25.710187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:19:25.710895 [debug] [MainThread]: On master: Close
[0m01:19:25.712289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:25.713353 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:19:25.714345 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:19:25.715280 [info ] [MainThread]: 
[0m01:19:25.716098 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:19:25.717859 [debug] [MainThread]: Command end result
[0m01:19:25.762578 [info ] [MainThread]: 
[0m01:19:25.763836 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:19:25.764778 [info ] [MainThread]: 
[0m01:19:25.765827 [error] [MainThread]:   Database Error in model ativos (models/prata/ativos.sql)
  subquery has too few columns
  LINE 7:                 data,ativo) in (
                                      ^
  compiled code at target/run/financas_data_pipeline/models/prata/ativos.sql
[0m01:19:25.766781 [info ] [MainThread]: 
[0m01:19:25.767666 [error] [MainThread]:   Database Error in model indicadores (models/prata/indicadores.sql)
  subquery has too few columns
  LINE 7:                 data,ativo) in (
                                      ^
  compiled code at target/run/financas_data_pipeline/models/prata/indicadores.sql
[0m01:19:25.768622 [info ] [MainThread]: 
[0m01:19:25.769465 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:19:25.770940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.62994, "process_user_time": 2.377536, "process_kernel_time": 0.128783, "process_mem_max_rss": "263348", "process_in_blocks": "52120", "command_success": false, "process_out_blocks": "0"}
[0m01:19:25.771967 [debug] [MainThread]: Command `dbt run` failed at 01:19:25.771873 after 1.63 seconds
[0m01:19:25.772769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5048358100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50472844f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5045b99940>]}
[0m01:19:25.773653 [debug] [MainThread]: Flushing usage events
[0m01:22:14.707453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cc8cf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cab7d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cab7d610>]}


============================== 01:22:14.714022 | a3bc1967-69c3-4a9b-8072-13fde1b2d655 ==============================
[0m01:22:14.714022 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:22:14.715147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'send_anonymous_usage_stats': 'True'}
[0m01:22:14.877683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ca1d2dc0>]}
[0m01:22:14.935830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb7fb4f0>]}
[0m01:22:14.937515 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:22:15.005236 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:22:15.239961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:22:15.241221 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:22:15.242250 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:22:15.501427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c9c02a00>]}
[0m01:22:15.647734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c9c4aeb0>]}
[0m01:22:15.648726 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:22:15.649620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ca11f430>]}
[0m01:22:15.651641 [info ] [MainThread]: 
[0m01:22:15.652737 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:22:15.657596 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:22:15.686340 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:22:15.687841 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:22:15.688818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:15.693864 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.005 seconds
[0m01:22:15.695914 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:22:15.698632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:22:15.699489 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:22:15.706307 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:22:15.708873 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:22:15.709793 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:22:15.710718 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:22:15.711539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:15.712311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:15.715335 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:22:15.715928 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:22:15.716486 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:22:15.717321 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:22:15.718340 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:22:15.719304 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:22:15.722249 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:22:15.722675 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:22:15.724293 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:22:15.725918 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:22:15.726827 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:22:15.727569 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:22:15.734052 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:15.735068 [debug] [MainThread]: On master: BEGIN
[0m01:22:15.736155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:15.739336 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:22:15.740192 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:15.741025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:22:15.743604 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:22:15.745024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cbea5250>]}
[0m01:22:15.745919 [debug] [MainThread]: On master: ROLLBACK
[0m01:22:15.746782 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:15.747490 [debug] [MainThread]: On master: BEGIN
[0m01:22:15.748367 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:22:15.749083 [debug] [MainThread]: On master: COMMIT
[0m01:22:15.749737 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:15.750440 [debug] [MainThread]: On master: COMMIT
[0m01:22:15.751347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:15.752216 [debug] [MainThread]: On master: Close
[0m01:22:15.753196 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:22:15.754194 [info ] [MainThread]: 
[0m01:22:15.762257 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:22:15.762974 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:22:15.763917 [info ] [Thread-1  ]: 1 of 3 START sql incremental model prata.ativos ................................ [RUN]
[0m01:22:15.764942 [info ] [Thread-2  ]: 2 of 3 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:22:15.765933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:22:15.766953 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:22:15.767979 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:22:15.768975 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:22:15.779914 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:22:15.783902 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:22:15.787655 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:22:15.794062 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:22:15.866392 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:22:15.868637 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:22:15.869444 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp012215831846"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando a coluna de ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."ativos")
    
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo a coluna renomeada como ativo
FROM ativos_limpos
  );
  
  
[0m01:22:15.870451 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp012215828173"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."indicadores")
    
)

SELECT 
    data,
    ativo, -- Mantendo a coluna renomeada como ativo
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:22:15.871414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:22:15.872239 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:22:15.876434 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:22:15.877768 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:22:15.878918 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:22:15.880639 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:22:15.881335 [debug] [Thread-1  ]: Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:22:15.883234 [debug] [Thread-2  ]: Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:22:15.885093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c90bbb20>]}
[0m01:22:15.886021 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67bafc15e0>]}
[0m01:22:15.887117 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model prata.ativos ....................... [[31mERROR[0m in 0.12s]
[0m01:22:15.888127 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model prata.indicadores .................. [[31mERROR[0m in 0.12s]
[0m01:22:15.889355 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:22:15.890689 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:22:15.891864 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:22:15.893910 [info ] [Thread-1  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:22:15.894999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:22:15.895889 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:22:15.900393 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:22:15.907211 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:22:15.911673 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.912752 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp012215910257"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:22:15.913821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:22:15.919100 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m01:22:15.933580 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.934711 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:22:15.935881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:22:15.936694 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.937703 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp012215910257'
        
      order by ordinal_position

  
[0m01:22:15.942337 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:22:15.947594 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.948407 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:22:15.950742 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:22:15.958552 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.959593 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:22:15.962497 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:22:15.979948 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:22:15.985093 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:15.985989 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp012215910257"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp012215910257"
    )
  
[0m01:22:15.987458 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m01:22:16.001961 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:22:16.003008 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:22:16.003966 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:22:16.005601 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:22:16.007835 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:22:16.008873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3bc1967-69c3-4a9b-8072-13fde1b2d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c9c4a130>]}
[0m01:22:16.009978 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.11s]
[0m01:22:16.011078 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:22:16.013011 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:16.014169 [debug] [MainThread]: On master: BEGIN
[0m01:22:16.015354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:22:16.018741 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:22:16.019985 [debug] [MainThread]: On master: COMMIT
[0m01:22:16.021127 [debug] [MainThread]: Using ***** connection "master"
[0m01:22:16.022315 [debug] [MainThread]: On master: COMMIT
[0m01:22:16.023461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:22:16.024624 [debug] [MainThread]: On master: Close
[0m01:22:16.025728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:16.026575 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:22:16.027330 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:22:16.028196 [info ] [MainThread]: 
[0m01:22:16.029292 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m01:22:16.031074 [debug] [MainThread]: Command end result
[0m01:22:16.074053 [info ] [MainThread]: 
[0m01:22:16.075351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:22:16.076263 [info ] [MainThread]: 
[0m01:22:16.077284 [error] [MainThread]:   Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:22:16.078078 [info ] [MainThread]: 
[0m01:22:16.079008 [error] [MainThread]:   Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:22:16.079853 [info ] [MainThread]: 
[0m01:22:16.080739 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:22:16.082041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4313536, "process_user_time": 2.253055, "process_kernel_time": 0.088936, "process_mem_max_rss": "263348", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:22:16.082943 [debug] [MainThread]: Command `dbt run` failed at 01:22:16.082849 after 1.43 seconds
[0m01:22:16.083732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cc8cf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb7fb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67cb29a9a0>]}
[0m01:22:16.084525 [debug] [MainThread]: Flushing usage events
[0m01:24:59.989734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5e1b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc40c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc40c9550>]}


============================== 01:24:59.995586 | 71f2996b-c2e3-4e6a-b382-3246ba0a2076 ==============================
[0m01:24:59.995586 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:24:59.996568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:00.160226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5a2fc10>]}
[0m01:25:00.215023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc4775280>]}
[0m01:25:00.216704 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:25:00.287173 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:25:00.496696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:00.497830 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:25:00.758835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc3170e80>]}
[0m01:25:00.906664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc366b430>]}
[0m01:25:00.907789 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:25:00.908839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc32cd2e0>]}
[0m01:25:00.911378 [info ] [MainThread]: 
[0m01:25:00.912570 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:25:00.917171 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:25:00.943417 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:25:00.944799 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:25:00.945958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:00.950172 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m01:25:00.952052 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:25:00.953995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:25:00.954642 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:25:00.961024 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:25:00.964086 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:25:00.965619 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:25:00.966484 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:25:00.967446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:00.968362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:00.971414 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:25:00.971976 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:25:00.972733 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:25:00.973674 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:25:00.974424 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:25:00.975255 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:25:00.977822 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:25:00.978195 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:25:00.979637 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:25:00.981371 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:25:00.982395 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:25:00.983089 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:25:00.989051 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:00.989994 [debug] [MainThread]: On master: BEGIN
[0m01:25:00.990838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:00.993876 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:25:00.994667 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:00.995515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:25:00.998275 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:25:01.000677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc4750cd0>]}
[0m01:25:01.001965 [debug] [MainThread]: On master: ROLLBACK
[0m01:25:01.003035 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:01.004127 [debug] [MainThread]: On master: BEGIN
[0m01:25:01.005292 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:25:01.006164 [debug] [MainThread]: On master: COMMIT
[0m01:25:01.007028 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:01.007974 [debug] [MainThread]: On master: COMMIT
[0m01:25:01.009101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:25:01.009996 [debug] [MainThread]: On master: Close
[0m01:25:01.011104 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:25:01.011992 [info ] [MainThread]: 
[0m01:25:01.018813 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:25:01.019553 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:25:01.020440 [info ] [Thread-1  ]: 1 of 3 START sql incremental model prata.ativos ................................ [RUN]
[0m01:25:01.021535 [info ] [Thread-2  ]: 2 of 3 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:25:01.022493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:25:01.024191 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:25:01.025092 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:25:01.026201 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:25:01.039176 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:25:01.043506 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:25:01.049056 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:25:01.049644 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:25:01.129592 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:25:01.130172 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:25:01.131329 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp012501086987"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."indicadores")
    
)

SELECT 
    data,
    ativo, -- Mantendo a coluna renomeada como ativo
    indicador,
    valor_indicador
FROM indicadores_limpos
  );
  
  
[0m01:25:01.132397 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp012501085980"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."ativos")
    
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
  
[0m01:25:01.133337 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:25:01.134251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:01.137913 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:25:01.138876 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:25:01.139434 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:25:01.140451 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:25:01.144919 [debug] [Thread-1  ]: Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:25:01.145653 [debug] [Thread-2  ]: Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:25:01.147558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc4d33250>]}
[0m01:25:01.148776 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc1daf160>]}
[0m01:25:01.150072 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model prata.ativos ....................... [[31mERROR[0m in 0.12s]
[0m01:25:01.151253 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model prata.indicadores .................. [[31mERROR[0m in 0.13s]
[0m01:25:01.152366 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:25:01.153477 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:25:01.154439 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:25:01.155825 [info ] [Thread-1  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:25:01.156787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:25:01.157619 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:25:01.162570 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:25:01.168604 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:25:01.172967 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.173868 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp012501171541"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:25:01.174670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:25:01.180351 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m01:25:01.195721 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.196917 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:25:01.198446 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:25:01.199382 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.200204 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp012501171541'
        
      order by ordinal_position

  
[0m01:25:01.204814 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:25:01.210612 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.211777 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:25:01.214461 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:25:01.222701 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.223787 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:25:01.226217 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:25:01.243561 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:25:01.251210 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.252522 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp012501171541"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp012501171541"
    )
  
[0m01:25:01.254132 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.001 seconds
[0m01:25:01.271732 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:25:01.272990 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:25:01.273974 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:25:01.275909 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:25:01.278662 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:25:01.280021 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2996b-c2e3-4e6a-b382-3246ba0a2076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc4750160>]}
[0m01:25:01.281215 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.12s]
[0m01:25:01.282300 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:25:01.284385 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:01.285353 [debug] [MainThread]: On master: BEGIN
[0m01:25:01.286219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:01.289469 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:25:01.290560 [debug] [MainThread]: On master: COMMIT
[0m01:25:01.291477 [debug] [MainThread]: Using ***** connection "master"
[0m01:25:01.292290 [debug] [MainThread]: On master: COMMIT
[0m01:25:01.293223 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:25:01.294041 [debug] [MainThread]: On master: Close
[0m01:25:01.295003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:01.295855 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:25:01.296566 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:25:01.297390 [info ] [MainThread]: 
[0m01:25:01.298269 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m01:25:01.299767 [debug] [MainThread]: Command end result
[0m01:25:01.343623 [info ] [MainThread]: 
[0m01:25:01.344927 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:25:01.345878 [info ] [MainThread]: 
[0m01:25:01.347192 [error] [MainThread]:   Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:25:01.348325 [info ] [MainThread]: 
[0m01:25:01.349524 [error] [MainThread]:   Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 24:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:25:01.350436 [info ] [MainThread]: 
[0m01:25:01.351353 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:25:01.352595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.419028, "process_user_time": 2.245012, "process_kernel_time": 0.13029, "process_mem_max_rss": "263352", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:01.353565 [debug] [MainThread]: Command `dbt run` failed at 01:25:01.353470 after 1.42 seconds
[0m01:25:01.354368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc5e1b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc58ff520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc47753d0>]}
[0m01:25:01.355153 [debug] [MainThread]: Flushing usage events
[0m01:26:56.882338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52eb2f80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e95a65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e95a6550>]}


============================== 01:26:56.888186 | 3f2395f6-5221-456e-8f25-d2c68cce4a83 ==============================
[0m01:26:56.888186 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:26:56.889197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:57.061187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52eaf0bc10>]}
[0m01:26:57.117870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e9c52280>]}
[0m01:26:57.119328 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:26:57.185910 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:26:57.406842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:26:57.408363 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:26:57.650660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e864be80>]}
[0m01:26:57.801144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e8ba1e20>]}
[0m01:26:57.802326 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:26:57.803611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e87ee790>]}
[0m01:26:57.806437 [info ] [MainThread]: 
[0m01:26:57.807864 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:26:57.812921 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:26:57.840675 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:26:57.841995 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:26:57.843128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:57.847745 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m01:26:57.849938 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:26:57.852232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:26:57.852950 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:26:57.859383 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:26:57.861897 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:26:57.862689 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:26:57.863641 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:26:57.864326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:57.865110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:57.868605 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:26:57.869044 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:26:57.869730 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:26:57.870681 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:26:57.871565 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:26:57.872573 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:26:57.875584 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:26:57.875988 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:26:57.877342 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:26:57.878880 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:26:57.879837 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:26:57.880675 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:26:57.886746 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:57.887721 [debug] [MainThread]: On master: BEGIN
[0m01:26:57.888500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:57.891891 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:26:57.892630 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:57.893346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:26:57.895807 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:26:57.897256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e955cc40>]}
[0m01:26:57.898166 [debug] [MainThread]: On master: ROLLBACK
[0m01:26:57.898998 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:57.899711 [debug] [MainThread]: On master: BEGIN
[0m01:26:57.900632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:26:57.901482 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.902373 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:57.903169 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.904206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:26:57.905057 [debug] [MainThread]: On master: Close
[0m01:26:57.905975 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:26:57.906809 [info ] [MainThread]: 
[0m01:26:57.913002 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:26:57.913473 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:26:57.914648 [info ] [Thread-1  ]: 1 of 3 START sql incremental model prata.ativos ................................ [RUN]
[0m01:26:57.915839 [info ] [Thread-2  ]: 2 of 3 START sql incremental model prata.indicadores ........................... [RUN]
[0m01:26:57.916839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:26:57.918689 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:26:57.920195 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:26:57.922329 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:26:57.934583 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:26:57.938569 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:26:57.942681 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:26:57.949052 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:26:58.021172 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:26:58.023136 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:26:58.024119 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

    
  
    

  create temporary table "indicadores__dbt_tmp012657980026"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando a coluna de ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."indicadores")
    
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
  
[0m01:26:58.025374 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

    
  
    

  create temporary table "ativos__dbt_tmp012657981646"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
    
      AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_nerds_prd"."prata"."ativos")
    
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
  
[0m01:26:58.026185 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:26:58.027066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:58.030431 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 25:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:26:58.030933 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "ativo" does not exist
LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                          ^

[0m01:26:58.031986 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:26:58.033137 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:26:58.036001 [debug] [Thread-2  ]: Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 25:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:26:58.037187 [debug] [Thread-1  ]: Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:26:58.039287 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e7bd43d0>]}
[0m01:26:58.040483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e7ae17c0>]}
[0m01:26:58.041870 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model prata.indicadores .................. [[31mERROR[0m in 0.12s]
[0m01:26:58.043078 [error] [Thread-1  ]: 1 of 3 ERROR creating sql incremental model prata.ativos ....................... [[31mERROR[0m in 0.12s]
[0m01:26:58.044306 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:26:58.045617 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:26:58.046644 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:26:58.048001 [info ] [Thread-2  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:26:58.049183 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.indicadores, now model.financas_data_pipeline.tesouro)
[0m01:26:58.050556 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:26:58.056530 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:26:58.062071 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:26:58.066638 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.067812 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp012658065176"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:26:58.068692 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:26:58.074401 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m01:26:58.091360 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.092574 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:26:58.094089 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m01:26:58.095123 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.095956 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp012658065176'
        
      order by ordinal_position

  
[0m01:26:58.100530 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.004 seconds
[0m01:26:58.106022 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.107180 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:26:58.110044 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:26:58.117947 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.119053 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:26:58.121620 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:26:58.137534 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:26:58.143338 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.144358 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp012658065176"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp012658065176"
    )
  
[0m01:26:58.145876 [debug] [Thread-2  ]: SQL status: INSERT 0 0 in 0.000 seconds
[0m01:26:58.161716 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:26:58.162891 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:26:58.163779 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:26:58.165427 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m01:26:58.167777 [debug] [Thread-2  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:26:58.168810 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2395f6-5221-456e-8f25-d2c68cce4a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e7ae17c0>]}
[0m01:26:58.169831 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.12s]
[0m01:26:58.170938 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:26:58.172721 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:58.173861 [debug] [MainThread]: On master: BEGIN
[0m01:26:58.174707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:58.177922 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:26:58.178754 [debug] [MainThread]: On master: COMMIT
[0m01:26:58.179481 [debug] [MainThread]: Using ***** connection "master"
[0m01:26:58.180165 [debug] [MainThread]: On master: COMMIT
[0m01:26:58.181292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:26:58.182053 [debug] [MainThread]: On master: Close
[0m01:26:58.182967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:58.183867 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:26:58.184710 [debug] [MainThread]: Connection 'model.financas_data_pipeline.ativos' was properly closed.
[0m01:26:58.185740 [info ] [MainThread]: 
[0m01:26:58.186579 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m01:26:58.187914 [debug] [MainThread]: Command end result
[0m01:26:58.238468 [info ] [MainThread]: 
[0m01:26:58.240088 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:26:58.241358 [info ] [MainThread]: 
[0m01:26:58.243392 [error] [MainThread]:   Database Error in model indicadores (models/prata/indicadores.sql)
  column "ativo" does not exist
  LINE 25:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:26:58.244762 [info ] [MainThread]: 
[0m01:26:58.246283 [error] [MainThread]:   Database Error in model ativos (models/prata/ativos.sql)
  column "ativo" does not exist
  LINE 27:       AND (data, ativo) NOT IN (SELECT data, ativo FROM "dw_...
                            ^
[0m01:26:58.247486 [info ] [MainThread]: 
[0m01:26:58.248453 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:26:58.249623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4234812, "process_user_time": 2.248218, "process_kernel_time": 0.110898, "process_mem_max_rss": "263340", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:26:58.250562 [debug] [MainThread]: Command `dbt run` failed at 01:26:58.250460 after 1.42 seconds
[0m01:26:58.251398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52eb2f80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52eaf0bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52e8b48280>]}
[0m01:26:58.252200 [debug] [MainThread]: Flushing usage events
[0m01:28:28.225828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e362fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e345a85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e345a8550>]}


============================== 01:28:28.232098 | c15a884b-daca-4f19-924f-d5042e4c5f51 ==============================
[0m01:28:28.232098 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:28:28.233543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:28:28.398373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35f0fc10>]}
[0m01:28:28.455710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34c55280>]}
[0m01:28:28.457398 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:28:28.531664 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:28:28.764730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:28:28.766220 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/ativos.sql
[0m01:28:28.767411 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/indicadores.sql
[0m01:28:29.009464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e31e7b130>]}
[0m01:28:29.156794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e33c188b0>]}
[0m01:28:29.157858 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:28:29.158840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e31e9c8e0>]}
[0m01:28:29.161006 [info ] [MainThread]: 
[0m01:28:29.162338 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:28:29.167380 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:28:29.194193 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:28:29.195557 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:28:29.196568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:29.200420 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m01:28:29.202001 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:28:29.203956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:28:29.204559 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:28:29.212341 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:28:29.215229 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:28:29.216201 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:28:29.217525 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:28:29.218723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:29.219560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:29.222695 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:28:29.223327 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:28:29.224115 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:28:29.224982 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:28:29.225703 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:28:29.226566 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:28:29.229977 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:28:29.230547 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:28:29.232144 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:28:29.234292 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:28:29.235804 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:28:29.236808 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:28:29.243288 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.244265 [debug] [MainThread]: On master: BEGIN
[0m01:28:29.245123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:29.248135 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:28:29.249168 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.250172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:28:29.252880 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:28:29.254635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e345a8be0>]}
[0m01:28:29.255576 [debug] [MainThread]: On master: ROLLBACK
[0m01:28:29.256428 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.257273 [debug] [MainThread]: On master: BEGIN
[0m01:28:29.258293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:28:29.259085 [debug] [MainThread]: On master: COMMIT
[0m01:28:29.259813 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.260552 [debug] [MainThread]: On master: COMMIT
[0m01:28:29.261365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:29.262080 [debug] [MainThread]: On master: Close
[0m01:28:29.263102 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:28:29.263993 [info ] [MainThread]: 
[0m01:28:29.270765 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:28:29.271262 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:28:29.272109 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m01:28:29.273277 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m01:28:29.274702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:28:29.276163 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:28:29.277167 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:28:29.278078 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:28:29.288434 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:28:29.292028 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:28:29.295594 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:28:29.301782 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:28:29.352496 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:28:29.354051 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:28:29.358137 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.358923 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.359735 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:28:29.360686 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:28:29.361633 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:28:29.362547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:28:29.366455 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m01:28:29.367242 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m01:28:29.367896 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.369061 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.370088 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m01:28:29.371330 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m01:28:29.378158 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.005 seconds
[0m01:28:29.385094 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.386114 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m01:28:29.387340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:29.391642 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.392482 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m01:28:29.393548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:29.411034 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.039 seconds
[0m01:28:29.413664 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:28:29.417220 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.418108 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.418935 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m01:28:29.419892 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:28:29.420869 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:29.424447 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.425191 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m01:28:29.425654 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m01:28:29.432583 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m01:28:29.433724 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:29.438113 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:28:29.440045 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:28:29.440929 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m01:28:29.441744 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.442891 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:28:29.443710 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:28:29.444165 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m01:28:29.448777 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:28:29.452603 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m01:28:29.455041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e312cff40>]}
[0m01:28:29.456234 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:28:29.457395 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 600[0m in 0.18s]
[0m01:28:29.458215 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m01:28:29.459395 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:28:29.460921 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:28:29.461481 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:28:29.462283 [info ] [Thread-1  ]: 3 of 3 START sql incremental model prata.tesouro ............................... [RUN]
[0m01:28:29.463997 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:28:29.464928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:28:29.465905 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e312cfa30>]}
[0m01:28:29.466624 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:28:29.467568 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 27614[0m in 0.19s]
[0m01:28:29.476963 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:28:29.478031 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:28:29.483274 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:28:29.513559 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.514779 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

    
  
    

  create temporary table "tesouro__dbt_tmp012829507915"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
    
      AND data > (SELECT MAX(data) FROM "dw_nerds_prd"."prata"."tesouro")
    
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
  
[0m01:28:29.515748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:28:29.521271 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m01:28:29.538234 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.539849 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:28:29.541372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m01:28:29.542441 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.543582 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'tesouro__dbt_tmp012829507915'
        
      order by ordinal_position

  
[0m01:28:29.549627 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.005 seconds
[0m01:28:29.555866 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.557129 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:28:29.560114 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:28:29.568025 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.569283 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dw_nerds_prd".INFORMATION_SCHEMA.columns
      where table_name = 'tesouro'
        
        and table_schema = 'prata'
        
      order by ordinal_position

  
[0m01:28:29.571961 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.002 seconds
[0m01:28:29.590162 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:28:29.595467 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.596411 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

      
        
            delete from "dw_nerds_prd"."prata"."tesouro"
            where (
                data) in (
                select (data)
                from "tesouro__dbt_tmp012829507915"
            );

        
    

    insert into "dw_nerds_prd"."prata"."tesouro" ("data", "rendimento")
    (
        select "data", "rendimento"
        from "tesouro__dbt_tmp012829507915"
    )
  
[0m01:28:29.597846 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.000 seconds
[0m01:28:29.600334 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:28:29.601755 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:28:29.602997 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:28:29.604672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:28:29.605974 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:28:29.607024 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c15a884b-daca-4f19-924f-d5042e4c5f51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e312cf820>]}
[0m01:28:29.608068 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model prata.tesouro .......................... [[32mINSERT 0 0[0m in 0.14s]
[0m01:28:29.609132 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:28:29.610892 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.611782 [debug] [MainThread]: On master: BEGIN
[0m01:28:29.612539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:29.615597 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:28:29.616645 [debug] [MainThread]: On master: COMMIT
[0m01:28:29.617492 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:29.618296 [debug] [MainThread]: On master: COMMIT
[0m01:28:29.619151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:29.620146 [debug] [MainThread]: On master: Close
[0m01:28:29.621249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:29.622056 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:28:29.622900 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:28:29.623759 [info ] [MainThread]: 
[0m01:28:29.624548 [info ] [MainThread]: Finished running 2 table models, 1 incremental model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:28:29.625826 [debug] [MainThread]: Command end result
[0m01:28:29.674682 [info ] [MainThread]: 
[0m01:28:29.676917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:29.678491 [info ] [MainThread]: 
[0m01:28:29.679993 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:28:29.681778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5167367, "process_user_time": 2.263388, "process_kernel_time": 0.144033, "process_mem_max_rss": "263340", "process_in_blocks": "200", "process_out_blocks": "0"}
[0m01:28:29.683701 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:29.683580 after 1.52 seconds
[0m01:28:29.684670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e362fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34cc5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34c55280>]}
[0m01:28:29.686007 [debug] [MainThread]: Flushing usage events
[0m01:28:32.693098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c04010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74be6af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74be6af550>]}


============================== 01:28:32.698726 | 522f5c5d-34a8-4141-905a-a925e13b9de3 ==============================
[0m01:28:32.698726 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:28:32.699727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'send_anonymous_usage_stats': 'True'}
[0m01:28:32.854804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c0015c10>]}
[0m01:28:32.906283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bed5a280>]}
[0m01:28:32.907836 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:28:32.977076 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:28:33.194181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:33.195152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:33.234521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bd8ed130>]}
[0m01:28:33.348006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bdbeb5e0>]}
[0m01:28:33.349524 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:28:33.351086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bdcb00d0>]}
[0m01:28:33.353199 [info ] [MainThread]: 
[0m01:28:33.354376 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:28:33.356302 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:28:33.417861 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:28:33.419387 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:28:33.420556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:33.425250 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m01:28:33.426944 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:28:33.432047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m01:28:33.432796 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m01:28:33.438975 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:28:33.441331 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:28:33.442358 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:28:33.443234 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:28:33.443964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:33.444971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:33.447932 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:28:33.448550 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:28:33.449105 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:28:33.449934 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:28:33.450707 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:28:33.451717 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:28:33.454462 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:28:33.454846 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:28:33.456341 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:28:33.457836 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:28:33.458704 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:28:33.459442 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:28:33.466820 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.468498 [debug] [MainThread]: On master: BEGIN
[0m01:28:33.469599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:33.472867 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:28:33.473810 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.474673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:28:33.477422 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:28:33.478973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bdd1e100>]}
[0m01:28:33.479926 [debug] [MainThread]: On master: ROLLBACK
[0m01:28:33.480806 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.481533 [debug] [MainThread]: On master: BEGIN
[0m01:28:33.482489 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:28:33.483280 [debug] [MainThread]: On master: COMMIT
[0m01:28:33.484015 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.484814 [debug] [MainThread]: On master: COMMIT
[0m01:28:33.485732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:33.486550 [debug] [MainThread]: On master: Close
[0m01:28:33.487494 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:28:33.488273 [info ] [MainThread]: 
[0m01:28:33.495776 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:28:33.496867 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m01:28:33.497881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.produto_dados_financeiros)
[0m01:28:33.498792 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m01:28:33.507849 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.513171 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m01:28:33.550358 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.555856 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.556800 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m01:28:33.557691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:28:33.561609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m01:28:33.562659 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.563542 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m01:28:33.574080 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.010 seconds
[0m01:28:33.581320 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.582396 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m01:28:33.583484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:33.586696 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.587534 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m01:28:33.588574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:28:33.610873 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:28:33.612159 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.613143 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:28:33.614685 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:28:33.621683 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m01:28:33.627467 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:28:33.628685 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m01:28:33.631175 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:28:33.634014 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m01:28:33.635906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '522f5c5d-34a8-4141-905a-a925e13b9de3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c006b850>]}
[0m01:28:33.636882 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.14s]
[0m01:28:33.638071 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:28:33.640125 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.641082 [debug] [MainThread]: On master: BEGIN
[0m01:28:33.642283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:33.645342 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:28:33.646170 [debug] [MainThread]: On master: COMMIT
[0m01:28:33.646927 [debug] [MainThread]: Using ***** connection "master"
[0m01:28:33.647794 [debug] [MainThread]: On master: COMMIT
[0m01:28:33.648642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:28:33.649321 [debug] [MainThread]: On master: Close
[0m01:28:33.650369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:33.651157 [debug] [MainThread]: Connection 'list_dw_nerds_prd_prata' was properly closed.
[0m01:28:33.651868 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m01:28:33.652569 [info ] [MainThread]: 
[0m01:28:33.653519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m01:28:33.654652 [debug] [MainThread]: Command end result
[0m01:28:33.696239 [info ] [MainThread]: 
[0m01:28:33.697312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:33.698272 [info ] [MainThread]: 
[0m01:28:33.699142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:28:33.700521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0699723, "process_user_time": 1.87837, "process_kernel_time": 0.120537, "process_mem_max_rss": "263344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:28:33.701604 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:33.701484 after 1.07 seconds
[0m01:28:33.702397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c04010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bff73580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bfebff70>]}
[0m01:28:33.703299 [debug] [MainThread]: Flushing usage events
[0m01:30:56.561556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f06ab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ee9595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ee959550>]}


============================== 01:30:56.567299 | be25fe28-e2c0-40b8-bfd0-d42e5c92f884 ==============================
[0m01:30:56.567299 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:30:56.568382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:56.726656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f02bfc10>]}
[0m01:30:56.777349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef004280>]}
[0m01:30:56.779038 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:30:56.851184 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:30:57.074934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:30:57.076154 [debug] [MainThread]: Partial parsing: updated file: financas_data_pipeline://models/prata/tesouro.sql
[0m01:30:57.336672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ec239130>]}
[0m01:30:57.483993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ede95ac0>]}
[0m01:30:57.485305 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:30:57.486375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ec1ab070>]}
[0m01:30:57.488110 [info ] [MainThread]: 
[0m01:30:57.489414 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:30:57.494743 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:30:57.523974 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:30:57.525573 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:30:57.526733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:57.530884 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m01:30:57.533236 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:30:57.536587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:30:57.537265 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:30:57.544007 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:30:57.546530 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:30:57.547513 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:30:57.548361 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:30:57.549150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:57.549992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:57.553150 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:30:57.553779 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:30:57.556886 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:30:57.558094 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:30:57.559168 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:30:57.560282 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:30:57.563228 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:30:57.563764 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:30:57.566121 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:30:57.568548 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:30:57.569963 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:30:57.570852 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:30:57.578093 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.579395 [debug] [MainThread]: On master: BEGIN
[0m01:30:57.580581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:57.585132 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:30:57.586297 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.587209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:30:57.590418 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:30:57.592184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6edede700>]}
[0m01:30:57.593090 [debug] [MainThread]: On master: ROLLBACK
[0m01:30:57.593987 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.594714 [debug] [MainThread]: On master: BEGIN
[0m01:30:57.595631 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:30:57.596453 [debug] [MainThread]: On master: COMMIT
[0m01:30:57.597274 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.598121 [debug] [MainThread]: On master: COMMIT
[0m01:30:57.599021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:30:57.599837 [debug] [MainThread]: On master: Close
[0m01:30:57.600838 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:30:57.601667 [info ] [MainThread]: 
[0m01:30:57.608020 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:30:57.608522 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:30:57.609488 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m01:30:57.610580 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m01:30:57.611520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m01:30:57.612508 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m01:30:57.613453 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:30:57.614412 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:30:57.624537 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:30:57.628304 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:30:57.631902 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:30:57.638339 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:30:57.685212 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:30:57.685879 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:30:57.689651 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.691055 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:30:57.691717 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.692625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:30:57.693661 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:30:57.695476 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:30:57.697669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m01:30:57.698955 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.699760 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m01:30:57.700380 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m01:30:57.701353 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.702722 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m01:30:57.707954 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.006 seconds
[0m01:30:57.716061 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.717621 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m01:30:57.718746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.722582 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.723991 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m01:30:57.725419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.739519 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.036 seconds
[0m01:30:57.745783 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:30:57.749223 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.750119 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.751055 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m01:30:57.751894 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:30:57.753183 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.757500 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.758208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m01:30:57.759178 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m01:30:57.766113 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m01:30:57.767215 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.771580 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:30:57.773496 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:30:57.774361 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m01:30:57.775268 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.776511 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:30:57.777432 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:30:57.777851 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m01:30:57.780466 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:30:57.783680 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m01:30:57.786066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e7661f40>]}
[0m01:30:57.787176 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:30:57.788537 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 600[0m in 0.17s]
[0m01:30:57.789576 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m01:30:57.790853 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:30:57.792197 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:30:57.793208 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m01:30:57.793705 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m01:30:57.794422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:30:57.796141 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:30:57.796905 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:30:57.798015 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e7661a30>]}
[0m01:30:57.801611 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:30:57.802779 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 27614[0m in 0.19s]
[0m01:30:57.804327 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:30:57.808464 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:30:57.812977 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:30:57.818891 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.820070 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:30:57.820974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:30:57.824274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:30:57.825274 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.826161 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m01:30:57.839720 [debug] [Thread-1  ]: SQL status: SELECT 12126 in 0.013 seconds
[0m01:30:57.845588 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.846629 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m01:30:57.847881 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.851126 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.852039 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m01:30:57.853473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:30:57.855242 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:30:57.856033 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.856783 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:30:57.859723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:30:57.862901 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m01:30:57.863916 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:30:57.864667 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m01:30:57.866978 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m01:30:57.868857 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:30:57.870200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be25fe28-e2c0-40b8-bfd0-d42e5c92f884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6e766b7c0>]}
[0m01:30:57.871632 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12126[0m in 0.08s]
[0m01:30:57.872979 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:30:57.875423 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.876664 [debug] [MainThread]: On master: BEGIN
[0m01:30:57.877979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:57.882115 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:30:57.883272 [debug] [MainThread]: On master: COMMIT
[0m01:30:57.884200 [debug] [MainThread]: Using ***** connection "master"
[0m01:30:57.885021 [debug] [MainThread]: On master: COMMIT
[0m01:30:57.886010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:30:57.886769 [debug] [MainThread]: On master: Close
[0m01:30:57.887743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:57.888686 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:30:57.889445 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:30:57.890347 [info ] [MainThread]: 
[0m01:30:57.891150 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:30:57.892550 [debug] [MainThread]: Command end result
[0m01:30:57.936553 [info ] [MainThread]: 
[0m01:30:57.937720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:57.938596 [info ] [MainThread]: 
[0m01:30:57.939470 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:30:57.940620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4395558, "process_user_time": 2.139428, "process_kernel_time": 0.190841, "process_mem_max_rss": "263344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:30:57.941628 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:57.941518 after 1.44 seconds
[0m01:30:57.942558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f06ab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ede95190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef004280>]}
[0m01:30:57.943484 [debug] [MainThread]: Flushing usage events
[0m01:31:00.608909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc986e16070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9850c35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9850c3550>]}


============================== 01:31:00.614425 | 122dcc82-49c1-4a22-89fd-e7405b44f994 ==============================
[0m01:31:00.614425 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:31:00.615506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:31:00.766949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc986a2a430>]}
[0m01:31:00.815784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc985d48160>]}
[0m01:31:00.818571 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:31:00.884947 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:31:01.109902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:01.110738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:01.152209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc984303130>]}
[0m01:31:01.267624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9846bfcd0>]}
[0m01:31:01.268797 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:31:01.269683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9842de8e0>]}
[0m01:31:01.271565 [info ] [MainThread]: 
[0m01:31:01.272738 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:31:01.274382 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:31:01.333941 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:31:01.335365 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:31:01.336257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:01.340069 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m01:31:01.341799 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:31:01.347160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:31:01.347959 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:31:01.354465 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:01.357275 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:01.358439 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:31:01.359365 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:31:01.360173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:01.360964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:01.363981 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:01.364543 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:01.365186 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:01.365995 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:01.366785 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:31:01.367613 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:31:01.370714 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m01:31:01.371225 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m01:31:01.372806 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:31:01.374454 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:31:01.375480 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:31:01.376337 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:31:01.383362 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.384288 [debug] [MainThread]: On master: BEGIN
[0m01:31:01.385035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:01.388042 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:31:01.389036 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.389892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:31:01.392604 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:01.394160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc986e88220>]}
[0m01:31:01.395118 [debug] [MainThread]: On master: ROLLBACK
[0m01:31:01.396125 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.396820 [debug] [MainThread]: On master: BEGIN
[0m01:31:01.398022 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:31:01.398861 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.399569 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.400345 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.401170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:01.401865 [debug] [MainThread]: On master: Close
[0m01:31:01.402751 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:31:01.403570 [info ] [MainThread]: 
[0m01:31:01.411475 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:01.412753 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m01:31:01.413985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.produto_dados_financeiros)
[0m01:31:01.414836 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:01.423768 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.428700 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:01.465110 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.472091 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.473151 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m01:31:01.474069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:01.477427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:31:01.478816 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.480371 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m01:31:01.507370 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.026 seconds
[0m01:31:01.514144 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.515224 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m01:31:01.516565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:01.520118 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.520969 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m01:31:01.521932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:01.540795 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:31:01.542218 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.543186 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:31:01.545275 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:31:01.554337 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m01:31:01.559669 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:01.560690 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m01:31:01.562999 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:31:01.565891 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m01:31:01.568175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '122dcc82-49c1-4a22-89fd-e7405b44f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc986a7f6d0>]}
[0m01:31:01.569621 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.15s]
[0m01:31:01.570770 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:01.572881 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.573720 [debug] [MainThread]: On master: BEGIN
[0m01:31:01.574447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:01.577736 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:31:01.578533 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.579257 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:01.579936 [debug] [MainThread]: On master: COMMIT
[0m01:31:01.580697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:01.581330 [debug] [MainThread]: On master: Close
[0m01:31:01.582168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:01.582948 [debug] [MainThread]: Connection 'list_dw_nerds_prd_ouro' was properly closed.
[0m01:31:01.583734 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m01:31:01.584615 [info ] [MainThread]: 
[0m01:31:01.585379 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m01:31:01.586349 [debug] [MainThread]: Command end result
[0m01:31:01.626458 [info ] [MainThread]: 
[0m01:31:01.628001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:01.628881 [info ] [MainThread]: 
[0m01:31:01.630007 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:31:01.631423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0801897, "process_user_time": 1.953708, "process_kernel_time": 0.040491, "process_mem_max_rss": "263348", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:31:01.632425 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:01.632324 after 1.08 seconds
[0m01:31:01.633260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc986e16070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc985776640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc984349df0>]}
[0m01:31:01.634077 [debug] [MainThread]: Flushing usage events
[0m01:31:45.077469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd35ea0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd1898520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd18984c0>]}


============================== 01:31:45.083498 | cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9 ==============================
[0m01:31:45.083498 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:31:45.084624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:31:45.239210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd187a250>]}
[0m01:31:45.299277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd18a8700>]}
[0m01:31:45.300788 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:31:45.370556 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:31:45.594305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:45.595399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:45.640054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0ad6130>]}
[0m01:31:45.754990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0a2b790>]}
[0m01:31:45.756327 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:31:45.757633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0ab1e80>]}
[0m01:31:45.759982 [info ] [MainThread]: 
[0m01:31:45.761342 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:31:45.766692 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:31:45.824706 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:31:45.826569 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:31:45.827711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:45.832595 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m01:31:45.834319 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:31:45.836339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m01:31:45.837171 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m01:31:45.842820 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:45.845640 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:45.846444 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:31:45.847494 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:31:45.848263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:45.848966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:45.852149 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:45.852633 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:45.853392 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:45.854285 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:45.855072 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:31:45.855870 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:31:45.859357 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m01:31:45.859819 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m01:31:45.861795 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:31:45.864007 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:31:45.865156 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:31:45.865967 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:31:45.871810 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:45.872692 [debug] [MainThread]: On master: BEGIN
[0m01:31:45.873438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:45.876412 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:31:45.877229 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:45.878026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:31:45.880620 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:45.882178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0a2bee0>]}
[0m01:31:45.883103 [debug] [MainThread]: On master: ROLLBACK
[0m01:31:45.883962 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:45.884684 [debug] [MainThread]: On master: BEGIN
[0m01:31:45.885695 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:31:45.886491 [debug] [MainThread]: On master: COMMIT
[0m01:31:45.887287 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:45.888056 [debug] [MainThread]: On master: COMMIT
[0m01:31:45.889066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:45.889787 [debug] [MainThread]: On master: Close
[0m01:31:45.890732 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:31:45.891665 [info ] [MainThread]: 
[0m01:31:45.898973 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m01:31:45.899447 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m01:31:45.900289 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m01:31:45.901324 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m01:31:45.902881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.ativos)
[0m01:31:45.903924 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.indicadores)
[0m01:31:45.904786 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m01:31:45.905612 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m01:31:45.914169 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m01:31:45.917608 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m01:31:45.921870 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m01:31:45.928271 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m01:31:45.974938 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m01:31:45.975583 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m01:31:45.980056 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:45.981085 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m01:31:45.981559 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:45.982286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:45.983078 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m01:31:45.984374 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m01:31:45.986580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m01:31:45.987172 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m01:31:45.988298 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:45.989346 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:45.990622 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m01:31:45.992011 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m01:31:45.997513 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.004 seconds
[0m01:31:46.004270 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:46.005120 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m01:31:46.006138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.009861 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:46.010812 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m01:31:46.011801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.029975 [debug] [Thread-2  ]: SQL status: SELECT 27614 in 0.036 seconds
[0m01:31:46.033164 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:31:46.036710 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:46.037907 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:46.038759 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m01:31:46.039712 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m01:31:46.040858 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.044283 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:46.045312 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m01:31:46.045775 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m01:31:46.046654 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.052857 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m01:31:46.054497 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:31:46.059145 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m01:31:46.060151 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:46.061001 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m01:31:46.061825 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m01:31:46.063540 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m01:31:46.064170 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m01:31:46.066690 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m01:31:46.069453 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m01:31:46.070550 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m01:31:46.072602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd32548b0>]}
[0m01:31:46.073482 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m01:31:46.075028 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 600[0m in 0.17s]
[0m01:31:46.076556 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m01:31:46.077320 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m01:31:46.077918 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m01:31:46.080375 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m01:31:46.081806 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m01:31:46.082985 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fcb6412b0>]}
[0m01:31:46.083800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m01:31:46.084804 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 27614[0m in 0.18s]
[0m01:31:46.085760 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m01:31:46.086733 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m01:31:46.091290 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m01:31:46.096602 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m01:31:46.101024 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m01:31:46.106124 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.107155 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m01:31:46.108491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:46.112010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:31:46.112940 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.114064 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m01:31:46.126355 [debug] [Thread-1  ]: SQL status: SELECT 12126 in 0.011 seconds
[0m01:31:46.130222 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.131300 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m01:31:46.132329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.135680 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.136804 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m01:31:46.138020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:46.139729 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:31:46.140628 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.141371 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m01:31:46.143971 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:31:46.146706 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m01:31:46.147778 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m01:31:46.148551 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m01:31:46.151182 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m01:31:46.153522 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m01:31:46.154672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf82cb16-c7a0-45fc-8eae-b8cfbc000dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0e3af40>]}
[0m01:31:46.156056 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12126[0m in 0.07s]
[0m01:31:46.157127 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m01:31:46.158950 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:46.159687 [debug] [MainThread]: On master: BEGIN
[0m01:31:46.160339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:46.163167 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:31:46.163825 [debug] [MainThread]: On master: COMMIT
[0m01:31:46.164479 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:46.165119 [debug] [MainThread]: On master: COMMIT
[0m01:31:46.166163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:46.167103 [debug] [MainThread]: On master: Close
[0m01:31:46.168054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:46.168817 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m01:31:46.169552 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m01:31:46.170316 [info ] [MainThread]: 
[0m01:31:46.171037 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m01:31:46.172218 [debug] [MainThread]: Command end result
[0m01:31:46.213710 [info ] [MainThread]: 
[0m01:31:46.214734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:46.215860 [info ] [MainThread]: 
[0m01:31:46.216895 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:31:46.218326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2088225, "process_user_time": 2.005614, "process_kernel_time": 0.110863, "process_mem_max_rss": "263344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:31:46.219431 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:46.219316 after 1.21 seconds
[0m01:31:46.220760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd35ea0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0b8d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd0a2be80>]}
[0m01:31:46.222487 [debug] [MainThread]: Flushing usage events
[0m01:31:49.090340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c1003040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf2b0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf2b0400>]}


============================== 01:31:49.096768 | fec7c008-b032-48df-a7e2-99886fac2058 ==============================
[0m01:31:49.096768 [info ] [MainThread]: Running with dbt=1.8.0
[0m01:31:49.097816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:31:49.265381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf31c520>]}
[0m01:31:49.317518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf2c1af0>]}
[0m01:31:49.318928 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m01:31:49.389827 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m01:31:49.614686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:31:49.615634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:31:49.653784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08be4f0130>]}
[0m01:31:49.781260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c0ad20a0>]}
[0m01:31:49.782742 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m01:31:49.783889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08be8b38b0>]}
[0m01:31:49.785914 [info ] [MainThread]: 
[0m01:31:49.787877 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m01:31:49.789999 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m01:31:49.858759 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m01:31:49.860163 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m01:31:49.861311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:49.865380 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m01:31:49.867176 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m01:31:49.872244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m01:31:49.872896 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m01:31:49.880077 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:49.882823 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:49.883999 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m01:31:49.884992 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m01:31:49.885890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:49.886797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:49.890341 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:49.891097 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m01:31:49.892047 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m01:31:49.893126 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m01:31:49.894115 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m01:31:49.895170 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m01:31:49.898463 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m01:31:49.899797 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m01:31:49.901516 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m01:31:49.903335 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m01:31:49.904461 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m01:31:49.905229 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m01:31:49.912189 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:49.913152 [debug] [MainThread]: On master: BEGIN
[0m01:31:49.913992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:49.917167 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:31:49.918754 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:49.919837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:31:49.923210 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:31:49.925252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08be7c81c0>]}
[0m01:31:49.926539 [debug] [MainThread]: On master: ROLLBACK
[0m01:31:49.927689 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:49.928599 [debug] [MainThread]: On master: BEGIN
[0m01:31:49.929677 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:31:49.930452 [debug] [MainThread]: On master: COMMIT
[0m01:31:49.931179 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:49.932146 [debug] [MainThread]: On master: COMMIT
[0m01:31:49.933195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:49.934116 [debug] [MainThread]: On master: Close
[0m01:31:49.935103 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m01:31:49.936092 [info ] [MainThread]: 
[0m01:31:49.944271 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:49.945898 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m01:31:49.946981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.produto_dados_financeiros)
[0m01:31:49.947805 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:49.957196 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:49.962574 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:50.000108 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.005300 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.006222 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m01:31:50.006992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:31:50.010220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:31:50.010998 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.011845 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m01:31:50.039212 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.026 seconds
[0m01:31:50.046060 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.047346 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m01:31:50.048569 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:31:50.066597 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:31:50.067933 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.068946 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m01:31:50.070911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:31:50.078065 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m01:31:50.084439 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m01:31:50.085815 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m01:31:50.087607 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m01:31:50.091292 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m01:31:50.093508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fec7c008-b032-48df-a7e2-99886fac2058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c0c6c850>]}
[0m01:31:50.094993 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.15s]
[0m01:31:50.096608 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m01:31:50.098615 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:50.099643 [debug] [MainThread]: On master: BEGIN
[0m01:31:50.100582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:50.104303 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m01:31:50.105350 [debug] [MainThread]: On master: COMMIT
[0m01:31:50.106183 [debug] [MainThread]: Using ***** connection "master"
[0m01:31:50.106940 [debug] [MainThread]: On master: COMMIT
[0m01:31:50.107774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:50.108496 [debug] [MainThread]: On master: Close
[0m01:31:50.109479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:50.110172 [debug] [MainThread]: Connection 'list_dw_nerds_prd_ouro' was properly closed.
[0m01:31:50.110941 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m01:31:50.111752 [info ] [MainThread]: 
[0m01:31:50.112820 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m01:31:50.114352 [debug] [MainThread]: Command end result
[0m01:31:50.155542 [info ] [MainThread]: 
[0m01:31:50.156619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:50.157584 [info ] [MainThread]: 
[0m01:31:50.158596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:31:50.160120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1308472, "process_user_time": 1.873488, "process_kernel_time": 0.147132, "process_mem_max_rss": "263348", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:31:50.161186 [debug] [MainThread]: Command `dbt run` succeeded at 01:31:50.161075 after 1.13 seconds
[0m01:31:50.162228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08c1003040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08bf963670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08be921820>]}
[0m01:31:50.163140 [debug] [MainThread]: Flushing usage events
[0m22:34:40.298082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f8df7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f70a5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f70a5610>]}


============================== 22:34:40.305361 | ec0a2886-4328-481e-b8f6-6c4a553d1633 ==============================
[0m22:34:40.305361 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:34:40.306742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:40.505864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f8a0a9d0>]}
[0m22:34:40.553622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f710f790>]}
[0m22:34:40.555289 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m22:34:40.630406 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:34:40.893614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:40.894719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:40.948498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f62e3130>]}
[0m22:34:41.074277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f657cd00>]}
[0m22:34:41.075289 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m22:34:41.076290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f64472e0>]}
[0m22:34:41.078615 [info ] [MainThread]: 
[0m22:34:41.079926 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m22:34:41.085334 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m22:34:41.143055 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m22:34:41.144357 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m22:34:41.145168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:41.148580 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m22:34:41.150469 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m22:34:41.152298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m22:34:41.152935 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m22:34:41.158767 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:34:41.166384 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:34:41.168304 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m22:34:41.170085 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m22:34:41.171008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:41.171734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:41.174506 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:34:41.175205 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:34:41.175724 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:34:41.176552 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:34:41.177424 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m22:34:41.178419 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m22:34:41.184229 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:34:41.184677 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:34:41.186136 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m22:34:41.187689 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m22:34:41.188904 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m22:34:41.189670 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m22:34:41.196091 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.197011 [debug] [MainThread]: On master: BEGIN
[0m22:34:41.197748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:41.200399 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:34:41.201203 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.202025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:41.205004 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m22:34:41.206495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f6239940>]}
[0m22:34:41.207421 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:41.208276 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.209024 [debug] [MainThread]: On master: BEGIN
[0m22:34:41.209930 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:41.210806 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.211548 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.212261 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.213019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:41.213801 [debug] [MainThread]: On master: Close
[0m22:34:41.214627 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m22:34:41.215460 [info ] [MainThread]: 
[0m22:34:41.222283 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m22:34:41.222748 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m22:34:41.224780 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m22:34:41.226904 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m22:34:41.228503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m22:34:41.229525 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m22:34:41.230622 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m22:34:41.231810 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m22:34:41.240265 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m22:34:41.243464 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m22:34:41.247508 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m22:34:41.248203 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m22:34:41.295551 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m22:34:41.296097 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m22:34:41.300329 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.301742 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m22:34:41.302348 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.303022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:34:41.303976 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m22:34:41.305702 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:34:41.307424 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:34:41.308547 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.309041 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m22:34:41.309740 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m22:34:41.310515 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.311753 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m22:34:41.315933 [debug] [Thread-1  ]: SQL status: SELECT 300 in 0.005 seconds
[0m22:34:41.323299 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.324270 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m22:34:41.325667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:41.328843 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.329755 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m22:34:41.330715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:41.338119 [debug] [Thread-2  ]: SQL status: SELECT 17725 in 0.026 seconds
[0m22:34:41.349084 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m22:34:41.352956 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.354149 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.355101 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m22:34:41.356003 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m22:34:41.357231 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:41.360828 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.361213 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m22:34:41.361833 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m22:34:41.367915 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m22:34:41.368926 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:41.372947 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:34:41.374662 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m22:34:41.375494 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m22:34:41.376305 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.377588 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m22:34:41.378366 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:34:41.381432 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m22:34:41.381914 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m22:34:41.383814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f57920a0>]}
[0m22:34:41.386620 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m22:34:41.387714 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 300[0m in 0.15s]
[0m22:34:41.388841 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:34:41.389802 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m22:34:41.390490 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m22:34:41.391358 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m22:34:41.392701 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m22:34:41.393219 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:34:41.393894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m22:34:41.395665 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m22:34:41.396449 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m22:34:41.397568 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f5792640>]}
[0m22:34:41.401863 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m22:34:41.402842 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 17725[0m in 0.17s]
[0m22:34:41.404436 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m22:34:41.407242 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m22:34:41.412087 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m22:34:41.419689 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.421078 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m22:34:41.422305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:34:41.426103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:34:41.427080 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.427973 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m22:34:41.437514 [debug] [Thread-1  ]: SQL status: SELECT 12129 in 0.009 seconds
[0m22:34:41.441142 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.442169 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m22:34:41.443667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:41.447406 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.448289 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m22:34:41.449532 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:41.451204 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m22:34:41.451996 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.452752 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m22:34:41.455205 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:34:41.458109 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m22:34:41.459117 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:34:41.459862 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m22:34:41.462863 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:41.464465 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m22:34:41.465415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec0a2886-4328-481e-b8f6-6c4a553d1633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f4e36bb0>]}
[0m22:34:41.466459 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12129[0m in 0.07s]
[0m22:34:41.467439 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m22:34:41.468995 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.469777 [debug] [MainThread]: On master: BEGIN
[0m22:34:41.470422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:41.472806 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m22:34:41.473514 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.474159 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:41.474877 [debug] [MainThread]: On master: COMMIT
[0m22:34:41.475644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:41.476484 [debug] [MainThread]: On master: Close
[0m22:34:41.477573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:41.478441 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m22:34:41.479133 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m22:34:41.479955 [info ] [MainThread]: 
[0m22:34:41.480737 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m22:34:41.481966 [debug] [MainThread]: Command end result
[0m22:34:41.521679 [info ] [MainThread]: 
[0m22:34:41.522836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:41.524032 [info ] [MainThread]: 
[0m22:34:41.524946 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:34:41.526266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2900366, "process_user_time": 2.032215, "process_kernel_time": 0.092373, "process_mem_max_rss": "272332", "process_in_blocks": "24840", "process_out_blocks": "0"}
[0m22:34:41.527285 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:41.527179 after 1.29 seconds
[0m22:34:41.528110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f8df7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f88c6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59f705bc70>]}
[0m22:34:41.528964 [debug] [MainThread]: Flushing usage events
[0m22:34:45.303165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500877f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006a2c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006a2c4c0>]}


============================== 22:34:45.308918 | 3d3d7fd0-0836-4055-8be6-9ca4d428168c ==============================
[0m22:34:45.308918 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:34:45.310144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'send_anonymous_usage_stats': 'True'}
[0m22:34:45.467099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006a0f250>]}
[0m22:34:45.515514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5006a3da30>]}
[0m22:34:45.517139 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m22:34:45.591474 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:34:45.814352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:45.815289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:45.853604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005c6c130>]}
[0m22:34:45.988835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005b86910>]}
[0m22:34:45.989995 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m22:34:45.991283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005c46e80>]}
[0m22:34:45.993706 [info ] [MainThread]: 
[0m22:34:45.995207 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m22:34:45.996825 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m22:34:46.082542 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m22:34:46.084508 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m22:34:46.085917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:46.108686 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.023 seconds
[0m22:34:46.116015 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m22:34:46.125767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m22:34:46.126738 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m22:34:46.137415 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:34:46.141170 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:34:46.142729 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m22:34:46.143953 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m22:34:46.144969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:46.146032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:46.149798 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:34:46.150552 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:34:46.151364 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:34:46.152390 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:34:46.153321 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m22:34:46.154215 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m22:34:46.156985 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:34:46.157885 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:34:46.159409 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m22:34:46.161218 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m22:34:46.162560 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m22:34:46.163372 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m22:34:46.170451 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.171542 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.172566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:46.176252 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:34:46.177330 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.178246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:34:46.181817 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:34:46.184063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50060be4c0>]}
[0m22:34:46.185038 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:46.186273 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.187145 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.188324 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:46.189629 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.190647 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.191600 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.192718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:46.193610 [debug] [MainThread]: On master: Close
[0m22:34:46.194740 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m22:34:46.195789 [info ] [MainThread]: 
[0m22:34:46.204239 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m22:34:46.205524 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m22:34:46.206825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.produto_dados_financeiros)
[0m22:34:46.207861 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m22:34:46.219021 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.227159 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m22:34:46.272256 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.278745 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.280015 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m22:34:46.281308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:34:46.284935 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:34:46.286515 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.287547 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m22:34:46.295296 [debug] [Thread-1  ]: SQL status: SELECT 300 in 0.007 seconds
[0m22:34:46.302254 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.303282 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m22:34:46.304415 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:46.307843 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.308659 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m22:34:46.309643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:46.329153 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m22:34:46.330216 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.331076 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m22:34:46.333015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:34:46.341365 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m22:34:46.346308 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:34:46.347329 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m22:34:46.349929 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:46.353031 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m22:34:46.355111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3d7fd0-0836-4055-8be6-9ca4d428168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50083e88b0>]}
[0m22:34:46.356485 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 300[0m in 0.15s]
[0m22:34:46.357534 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m22:34:46.359201 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.360010 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.360928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:46.363815 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:34:46.364769 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.365624 [debug] [MainThread]: Using ***** connection "master"
[0m22:34:46.366463 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.367470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:46.368395 [debug] [MainThread]: On master: Close
[0m22:34:46.369690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:46.370600 [debug] [MainThread]: Connection 'list_dw_nerds_prd_ouro' was properly closed.
[0m22:34:46.371433 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m22:34:46.372366 [info ] [MainThread]: 
[0m22:34:46.373220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m22:34:46.374247 [debug] [MainThread]: Command end result
[0m22:34:46.416608 [info ] [MainThread]: 
[0m22:34:46.417925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:46.419246 [info ] [MainThread]: 
[0m22:34:46.420433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:34:46.421958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1871066, "process_user_time": 2.145446, "process_kernel_time": 0.090229, "process_mem_max_rss": "272336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:46.423158 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:46.423051 after 1.19 seconds
[0m22:34:46.423982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f500877f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50070dc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5005b86040>]}
[0m22:34:46.424806 [debug] [MainThread]: Flushing usage events
[0m00:00:20.972472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc476f880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc475236640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4752365e0>]}


============================== 00:00:20.979230 | 5139d03e-f82c-4996-b5a4-26c88d9b09e4 ==============================
[0m00:00:20.979230 [info ] [MainThread]: Running with dbt=1.8.0
[0m00:00:20.980225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:00:21.220029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc47524f130>]}
[0m00:00:21.280916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc475246d00>]}
[0m00:00:21.282563 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m00:00:21.355643 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m00:00:21.627176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:21.628166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:21.669364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc474474130>]}
[0m00:00:21.793169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc474484460>]}
[0m00:00:21.795150 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m00:00:21.796440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc474616ee0>]}
[0m00:00:21.798405 [info ] [MainThread]: 
[0m00:00:21.799561 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m00:00:21.804264 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m00:00:21.866515 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m00:00:21.867533 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m00:00:21.868329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:21.872868 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m00:00:21.874964 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m00:00:21.876865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m00:00:21.877617 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m00:00:21.883838 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m00:00:21.886425 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m00:00:21.887297 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m00:00:21.888174 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m00:00:21.888986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:21.889878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:21.892874 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:21.893657 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:21.894337 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m00:00:21.895133 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m00:00:21.895913 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m00:00:21.896651 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m00:00:21.899895 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m00:00:21.900256 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m00:00:21.901743 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m00:00:21.903712 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m00:00:21.905176 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m00:00:21.906048 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m00:00:21.912355 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:21.913431 [debug] [MainThread]: On master: BEGIN
[0m00:00:21.914351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:21.917231 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:00:21.918239 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:21.919144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:21.921942 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:00:21.923578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc474838910>]}
[0m00:00:21.924664 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:21.925498 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:21.926229 [debug] [MainThread]: On master: BEGIN
[0m00:00:21.927178 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:21.927879 [debug] [MainThread]: On master: COMMIT
[0m00:00:21.928542 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:21.929205 [debug] [MainThread]: On master: COMMIT
[0m00:00:21.929955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:21.930699 [debug] [MainThread]: On master: Close
[0m00:00:21.931597 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m00:00:21.932574 [info ] [MainThread]: 
[0m00:00:21.940923 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m00:00:21.941449 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m00:00:21.942345 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m00:00:21.943416 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m00:00:21.944349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m00:00:21.945239 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m00:00:21.946242 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m00:00:21.947183 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m00:00:21.956779 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m00:00:21.960497 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m00:00:21.965402 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m00:00:21.972116 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m00:00:22.028325 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m00:00:22.028991 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m00:00:22.033178 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.034309 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m00:00:22.035120 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.036141 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m00:00:22.037282 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m00:00:22.039340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:22.041049 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m00:00:22.042054 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.042750 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m00:00:22.043597 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m00:00:22.044493 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.045809 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m00:00:22.051225 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.004 seconds
[0m00:00:22.059347 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.060534 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m00:00:22.061980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.066129 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.067101 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m00:00:22.068312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.087389 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m00:00:22.087891 [debug] [Thread-2  ]: SQL status: SELECT 32564 in 0.043 seconds
[0m00:00:22.088889 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.092822 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.094049 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m00:00:22.094984 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m00:00:22.096881 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.100327 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.100744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m00:00:22.101397 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m00:00:22.109242 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m00:00:22.110523 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.115770 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m00:00:22.118253 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m00:00:22.119548 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m00:00:22.120597 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.122205 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m00:00:22.123412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m00:00:22.124122 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m00:00:22.127218 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m00:00:22.130656 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m00:00:22.132945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4739222b0>]}
[0m00:00:22.134010 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m00:00:22.135466 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 600[0m in 0.19s]
[0m00:00:22.136548 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m00:00:22.137824 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m00:00:22.139621 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m00:00:22.140939 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m00:00:22.141710 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.003 seconds
[0m00:00:22.142668 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m00:00:22.144907 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m00:00:22.146107 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m00:00:22.147316 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4739226a0>]}
[0m00:00:22.156510 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m00:00:22.157896 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 32564[0m in 0.20s]
[0m00:00:22.159767 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m00:00:22.163485 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m00:00:22.168404 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m00:00:22.173320 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.174612 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m00:00:22.175631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:22.178585 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m00:00:22.179535 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.180540 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m00:00:22.193257 [debug] [Thread-1  ]: SQL status: SELECT 12129 in 0.012 seconds
[0m00:00:22.197971 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.199415 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m00:00:22.201157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.205642 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.206722 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m00:00:22.207870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:22.209873 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m00:00:22.210983 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.211931 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m00:00:22.214450 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m00:00:22.218096 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m00:00:22.219554 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m00:00:22.220657 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m00:00:22.223370 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m00:00:22.226559 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m00:00:22.228037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5139d03e-f82c-4996-b5a4-26c88d9b09e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc474484b80>]}
[0m00:00:22.229621 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12129[0m in 0.09s]
[0m00:00:22.231004 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m00:00:22.232803 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:22.233823 [debug] [MainThread]: On master: BEGIN
[0m00:00:22.234703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:22.238306 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:22.239300 [debug] [MainThread]: On master: COMMIT
[0m00:00:22.240129 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:22.240906 [debug] [MainThread]: On master: COMMIT
[0m00:00:22.241764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:22.242482 [debug] [MainThread]: On master: Close
[0m00:00:22.243652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:22.244929 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m00:00:22.245718 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m00:00:22.246473 [info ] [MainThread]: 
[0m00:00:22.247225 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m00:00:22.248442 [debug] [MainThread]: Command end result
[0m00:00:22.288512 [info ] [MainThread]: 
[0m00:00:22.289520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:22.290255 [info ] [MainThread]: 
[0m00:00:22.291055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:00:22.292417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3956736, "process_user_time": 2.111004, "process_kernel_time": 0.182683, "process_mem_max_rss": "272340", "process_in_blocks": "51496", "process_out_blocks": "0"}
[0m00:00:22.293344 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:22.293233 after 1.40 seconds
[0m00:00:22.294502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc476f880d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4745ca100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4744842b0>]}
[0m00:00:22.295439 [debug] [MainThread]: Flushing usage events
[0m00:00:25.113879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b438c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b41b715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b41b71550>]}


============================== 00:00:25.119943 | e709a525-f51b-4d79-ab6d-15238376126d ==============================
[0m00:00:25.119943 [info ] [MainThread]: Running with dbt=1.8.0
[0m00:00:25.121065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:00:25.285691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b434d8430>]}
[0m00:00:25.342468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b427f6eb0>]}
[0m00:00:25.343952 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m00:00:25.414095 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m00:00:25.637361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:25.638646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:25.679856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b40db0130>]}
[0m00:00:25.801768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b40dc11c0>]}
[0m00:00:25.802927 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m00:00:25.804235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b40d8b8e0>]}
[0m00:00:25.807161 [info ] [MainThread]: 
[0m00:00:25.808386 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m00:00:25.810016 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m00:00:25.869554 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m00:00:25.870560 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m00:00:25.871370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:25.875370 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m00:00:25.877258 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m00:00:25.883097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m00:00:25.884675 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m00:00:25.892076 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m00:00:25.895013 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m00:00:25.896061 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m00:00:25.896878 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m00:00:25.897670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:25.898494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:25.901698 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:25.902430 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:25.903085 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m00:00:25.904141 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m00:00:25.905473 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m00:00:25.906464 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m00:00:25.909335 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m00:00:25.911534 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m00:00:25.911947 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m00:00:25.912758 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m00:00:25.914359 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m00:00:25.917303 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m00:00:25.923544 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:25.925140 [debug] [MainThread]: On master: BEGIN
[0m00:00:25.926232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:25.929211 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m00:00:25.930095 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:25.930881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:25.933383 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m00:00:25.935462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b40dc11f0>]}
[0m00:00:25.936710 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:25.937794 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:25.938645 [debug] [MainThread]: On master: BEGIN
[0m00:00:25.939887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:25.940794 [debug] [MainThread]: On master: COMMIT
[0m00:00:25.941659 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:25.942487 [debug] [MainThread]: On master: COMMIT
[0m00:00:25.943457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:25.944366 [debug] [MainThread]: On master: Close
[0m00:00:25.945720 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m00:00:25.946654 [info ] [MainThread]: 
[0m00:00:25.954015 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m00:00:25.955455 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m00:00:25.956483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.produto_dados_financeiros)
[0m00:00:25.957356 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m00:00:25.967666 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:25.972284 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m00:00:26.011881 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.017300 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.018258 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m00:00:26.019185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:00:26.022258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m00:00:26.023293 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.024893 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m00:00:26.054352 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.028 seconds
[0m00:00:26.061359 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.062365 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m00:00:26.063654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:26.067433 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.068692 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m00:00:26.069910 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:00:26.089463 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m00:00:26.090504 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.091297 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m00:00:26.092875 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m00:00:26.101401 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m00:00:26.106760 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m00:00:26.107860 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m00:00:26.110017 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m00:00:26.112710 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m00:00:26.114958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e709a525-f51b-4d79-ab6d-15238376126d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4352d6d0>]}
[0m00:00:26.116429 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.16s]
[0m00:00:26.117587 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m00:00:26.119912 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:26.120882 [debug] [MainThread]: On master: BEGIN
[0m00:00:26.121640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:26.125863 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:26.127489 [debug] [MainThread]: On master: COMMIT
[0m00:00:26.128460 [debug] [MainThread]: Using ***** connection "master"
[0m00:00:26.129262 [debug] [MainThread]: On master: COMMIT
[0m00:00:26.130136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:26.130900 [debug] [MainThread]: On master: Close
[0m00:00:26.131831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:26.132587 [debug] [MainThread]: Connection 'list_dw_nerds_prd_prata' was properly closed.
[0m00:00:26.133681 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m00:00:26.134770 [info ] [MainThread]: 
[0m00:00:26.135881 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:00:26.137807 [debug] [MainThread]: Command end result
[0m00:00:26.180383 [info ] [MainThread]: 
[0m00:00:26.181560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:26.182464 [info ] [MainThread]: 
[0m00:00:26.183423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:00:26.185297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1358304, "process_user_time": 1.892947, "process_kernel_time": 0.132302, "process_mem_max_rss": "272336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:00:26.186628 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:26.186428 after 1.14 seconds
[0m00:00:26.187756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b438c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4221e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4336bac0>]}
[0m00:00:26.188802 [debug] [MainThread]: Flushing usage events
[0m02:42:40.030023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6d2cb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6b579670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6b579610>]}


============================== 02:42:40.035569 | b17e6ba2-f8cd-47bc-aec0-91be3e79df64 ==============================
[0m02:42:40.035569 [info ] [MainThread]: Running with dbt=1.8.0
[0m02:42:40.036657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:42:40.196967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6b73f790>]}
[0m02:42:40.243446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6ab166a0>]}
[0m02:42:40.245541 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m02:42:40.310976 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m02:42:40.593251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:40.594213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:40.630538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6a7b7130>]}
[0m02:42:40.741141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6a70aeb0>]}
[0m02:42:40.742588 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m02:42:40.743940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6a7b5640>]}
[0m02:42:40.746637 [info ] [MainThread]: 
[0m02:42:40.748250 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m02:42:40.757372 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m02:42:40.822683 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m02:42:40.823762 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m02:42:40.824782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:40.835448 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.011 seconds
[0m02:42:40.837410 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m02:42:40.839526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m02:42:40.840284 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m02:42:40.846682 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m02:42:40.849046 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m02:42:40.850510 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m02:42:40.851404 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m02:42:40.852278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:40.853001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:40.855936 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:42:40.856522 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:42:40.857203 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m02:42:40.858099 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m02:42:40.859307 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m02:42:40.860608 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m02:42:40.869805 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m02:42:40.870375 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m02:42:40.872017 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m02:42:40.873636 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m02:42:40.874652 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m02:42:40.875370 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m02:42:40.881746 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:40.882716 [debug] [MainThread]: On master: BEGIN
[0m02:42:40.883477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:40.886247 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:42:40.887005 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:40.887789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:42:40.893148 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m02:42:40.894968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6ab683a0>]}
[0m02:42:40.895969 [debug] [MainThread]: On master: ROLLBACK
[0m02:42:40.896868 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:40.897617 [debug] [MainThread]: On master: BEGIN
[0m02:42:40.898523 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:42:40.899538 [debug] [MainThread]: On master: COMMIT
[0m02:42:40.900501 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:40.901330 [debug] [MainThread]: On master: COMMIT
[0m02:42:40.902197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:40.902937 [debug] [MainThread]: On master: Close
[0m02:42:40.903781 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m02:42:40.904583 [info ] [MainThread]: 
[0m02:42:40.912207 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m02:42:40.912718 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m02:42:40.914270 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m02:42:40.915258 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m02:42:40.916150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.ativos)
[0m02:42:40.916974 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.indicadores)
[0m02:42:40.917761 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m02:42:40.918515 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m02:42:40.927430 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m02:42:40.930976 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m02:42:40.934307 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m02:42:40.940656 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m02:42:40.995575 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m02:42:40.996287 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m02:42:41.000300 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.001277 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.002222 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m02:42:41.003321 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m02:42:41.004520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:41.005530 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:42:41.008651 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m02:42:41.009451 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m02:42:41.010102 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.011120 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.012092 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m02:42:41.013043 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m02:42:41.029474 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.015 seconds
[0m02:42:41.038360 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.039514 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m02:42:41.041215 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:42:41.044812 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.045632 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m02:42:41.046706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:41.065114 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m02:42:41.065626 [debug] [Thread-2  ]: SQL status: SELECT 32564 in 0.051 seconds
[0m02:42:41.066395 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.069918 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.071140 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m02:42:41.072062 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m02:42:41.073999 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:42:41.078211 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.078649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m02:42:41.079708 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m02:42:41.086162 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m02:42:41.087179 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:41.091425 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m02:42:41.093317 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m02:42:41.094153 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m02:42:41.094886 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.096132 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m02:42:41.098687 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m02:42:41.101643 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m02:42:41.102085 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m02:42:41.102928 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m02:42:41.105636 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m02:42:41.106565 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m02:42:41.108592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6e304c40>]}
[0m02:42:41.110433 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 600[0m in 0.19s]
[0m02:42:41.111230 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m02:42:41.111977 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m02:42:41.113613 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m02:42:41.114531 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m02:42:41.115556 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d69c297f0>]}
[0m02:42:41.116334 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m02:42:41.117285 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 32564[0m in 0.20s]
[0m02:42:41.118221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m02:42:41.119312 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m02:42:41.120183 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m02:42:41.124139 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m02:42:41.128203 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m02:42:41.132919 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m02:42:41.140637 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.141615 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m02:42:41.142620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:41.146045 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m02:42:41.147149 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.147994 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m02:42:41.160067 [debug] [Thread-1  ]: SQL status: SELECT 12129 in 0.011 seconds
[0m02:42:41.163810 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.164729 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m02:42:41.166323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:42:41.169718 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.170643 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m02:42:41.171706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:41.173308 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m02:42:41.174032 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.174829 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m02:42:41.176812 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:42:41.179440 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m02:42:41.180428 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m02:42:41.181250 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m02:42:41.183281 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m02:42:41.184892 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m02:42:41.185812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b17e6ba2-f8cd-47bc-aec0-91be3e79df64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6935c550>]}
[0m02:42:41.186839 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12129[0m in 0.07s]
[0m02:42:41.187876 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m02:42:41.189512 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:41.190844 [debug] [MainThread]: On master: BEGIN
[0m02:42:41.191592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:41.194251 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:42:41.195025 [debug] [MainThread]: On master: COMMIT
[0m02:42:41.195820 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:41.196508 [debug] [MainThread]: On master: COMMIT
[0m02:42:41.197402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:41.198144 [debug] [MainThread]: On master: Close
[0m02:42:41.199232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:41.200351 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m02:42:41.201208 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m02:42:41.202048 [info ] [MainThread]: 
[0m02:42:41.202920 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m02:42:41.204436 [debug] [MainThread]: Command end result
[0m02:42:41.241336 [info ] [MainThread]: 
[0m02:42:41.242396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:41.243275 [info ] [MainThread]: 
[0m02:42:41.244176 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:42:41.245503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2811053, "process_user_time": 1.888938, "process_kernel_time": 0.164676, "process_mem_max_rss": "271964", "process_in_blocks": "2320", "process_out_blocks": "0"}
[0m02:42:41.246532 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:41.246436 after 1.28 seconds
[0m02:42:41.247429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6d2cb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6a70a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6a70a730>]}
[0m02:42:41.248279 [debug] [MainThread]: Flushing usage events
[0m02:42:44.941349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b900300d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8e2de520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8e2de4c0>]}


============================== 02:42:44.946715 | 5763d34d-b12f-406e-b3b9-43ffdcebf5f9 ==============================
[0m02:42:44.946715 [info ] [MainThread]: Running with dbt=1.8.0
[0m02:42:44.947818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:42:45.087691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d9706d0>]}
[0m02:42:45.139309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8e98bb20>]}
[0m02:42:45.141024 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m02:42:45.207758 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m02:42:45.430182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:42:45.431633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:42:45.472514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d51d130>]}
[0m02:42:45.589923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d471ee0>]}
[0m02:42:45.591100 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m02:42:45.592118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d6901c0>]}
[0m02:42:45.593860 [info ] [MainThread]: 
[0m02:42:45.594945 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m02:42:45.596344 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m02:42:45.651700 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m02:42:45.652773 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m02:42:45.653641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:45.657199 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m02:42:45.658803 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m02:42:45.663935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_prata)
[0m02:42:45.664570 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_ouro'
[0m02:42:45.670409 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m02:42:45.672561 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m02:42:45.673400 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m02:42:45.674148 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m02:42:45.674877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:45.675679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:45.679332 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:42:45.680055 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m02:42:45.680664 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m02:42:45.681493 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m02:42:45.682320 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m02:42:45.683126 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m02:42:45.685468 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m02:42:45.686025 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m02:42:45.687421 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m02:42:45.689019 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m02:42:45.689953 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m02:42:45.690702 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m02:42:45.697006 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.699182 [debug] [MainThread]: On master: BEGIN
[0m02:42:45.700287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:45.703813 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m02:42:45.704631 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.705517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:42:45.707948 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m02:42:45.709855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b91ff0d60>]}
[0m02:42:45.710888 [debug] [MainThread]: On master: ROLLBACK
[0m02:42:45.711771 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.712644 [debug] [MainThread]: On master: BEGIN
[0m02:42:45.713623 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:42:45.714374 [debug] [MainThread]: On master: COMMIT
[0m02:42:45.715110 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.715848 [debug] [MainThread]: On master: COMMIT
[0m02:42:45.716754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:45.717524 [debug] [MainThread]: On master: Close
[0m02:42:45.718469 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m02:42:45.719396 [info ] [MainThread]: 
[0m02:42:45.727544 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m02:42:45.728635 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m02:42:45.729632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.produto_dados_financeiros)
[0m02:42:45.730450 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m02:42:45.739647 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.744214 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m02:42:45.790526 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.795530 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.796533 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m02:42:45.797472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:42:45.801742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m02:42:45.802881 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.803790 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m02:42:45.834115 [debug] [Thread-1  ]: SQL status: SELECT 600 in 0.029 seconds
[0m02:42:45.841616 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.842839 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m02:42:45.844174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:45.847538 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.848340 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m02:42:45.849459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:42:45.869840 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m02:42:45.871408 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.872912 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m02:42:45.875092 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m02:42:45.882158 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m02:42:45.886665 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m02:42:45.887624 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m02:42:45.890529 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m02:42:45.893804 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m02:42:45.895708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5763d34d-b12f-406e-b3b9-43ffdcebf5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8c0c9730>]}
[0m02:42:45.896805 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 600[0m in 0.17s]
[0m02:42:45.897861 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m02:42:45.899827 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.901162 [debug] [MainThread]: On master: BEGIN
[0m02:42:45.902176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:45.905278 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:42:45.906131 [debug] [MainThread]: On master: COMMIT
[0m02:42:45.906958 [debug] [MainThread]: Using ***** connection "master"
[0m02:42:45.907760 [debug] [MainThread]: On master: COMMIT
[0m02:42:45.908632 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:42:45.909389 [debug] [MainThread]: On master: Close
[0m02:42:45.910633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:45.911811 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m02:42:45.912634 [debug] [MainThread]: Connection 'list_dw_nerds_prd_ouro' was properly closed.
[0m02:42:45.913450 [info ] [MainThread]: 
[0m02:42:45.914315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:42:45.915430 [debug] [MainThread]: Command end result
[0m02:42:45.957758 [info ] [MainThread]: 
[0m02:42:45.958829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:45.959970 [info ] [MainThread]: 
[0m02:42:45.961226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:42:45.962680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0718836, "process_user_time": 1.765309, "process_kernel_time": 0.138844, "process_mem_max_rss": "271964", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:42:45.963740 [debug] [MainThread]: Command `dbt run` succeeded at 02:42:45.963629 after 1.07 seconds
[0m02:42:45.964619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b900300d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8e98e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8d4719a0>]}
[0m02:42:45.965398 [debug] [MainThread]: Flushing usage events
[0m22:00:22.150126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa260654040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25e9035b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25e903550>]}


============================== 22:00:22.156004 | 176521b1-51d2-42b0-ae5d-3461dc1cac9d ==============================
[0m22:00:22.156004 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:00:22.157096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select prata', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:00:22.321779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25df539a0>]}
[0m22:00:22.371456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25e916a00>]}
[0m22:00:22.373740 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m22:00:22.443009 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:00:22.684917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:22.685895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:22.727507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25db40130>]}
[0m22:00:22.856335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25de80490>]}
[0m22:00:22.858274 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m22:00:22.859288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25de80520>]}
[0m22:00:22.861341 [info ] [MainThread]: 
[0m22:00:22.862858 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m22:00:22.867621 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m22:00:22.940889 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m22:00:22.942149 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m22:00:22.943195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:22.948379 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.005 seconds
[0m22:00:22.950868 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m22:00:22.953383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m22:00:22.954188 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m22:00:22.961984 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:00:22.965737 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:00:22.967138 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m22:00:22.968073 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m22:00:22.968976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:22.969823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:22.972721 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m22:00:22.973260 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m22:00:22.974037 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:00:22.974860 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:00:22.975838 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m22:00:22.976738 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m22:00:22.982001 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:00:22.982445 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:00:22.983984 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m22:00:22.985829 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m22:00:22.986861 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m22:00:22.987768 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m22:00:22.996965 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:22.998019 [debug] [MainThread]: On master: BEGIN
[0m22:00:22.998857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:23.001891 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:00:23.002693 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:23.003477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:23.006623 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m22:00:23.008288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25de5e8b0>]}
[0m22:00:23.009281 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:23.010158 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:23.010861 [debug] [MainThread]: On master: BEGIN
[0m22:00:23.011948 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:00:23.012705 [debug] [MainThread]: On master: COMMIT
[0m22:00:23.013590 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:23.014408 [debug] [MainThread]: On master: COMMIT
[0m22:00:23.015305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:23.016263 [debug] [MainThread]: On master: Close
[0m22:00:23.017243 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m22:00:23.018079 [info ] [MainThread]: 
[0m22:00:23.026685 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.ativos
[0m22:00:23.027199 [debug] [Thread-2  ]: Began running node model.financas_data_pipeline.indicadores
[0m22:00:23.028176 [info ] [Thread-1  ]: 1 of 3 START sql table model prata.ativos ...................................... [RUN]
[0m22:00:23.029426 [info ] [Thread-2  ]: 2 of 3 START sql table model prata.indicadores ................................. [RUN]
[0m22:00:23.030553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.ativos)
[0m22:00:23.031447 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_ouro, now model.financas_data_pipeline.indicadores)
[0m22:00:23.032369 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.ativos
[0m22:00:23.033254 [debug] [Thread-2  ]: Began compiling node model.financas_data_pipeline.indicadores
[0m22:00:23.041984 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.ativos"
[0m22:00:23.045388 [debug] [Thread-2  ]: Writing injected SQL for node "model.financas_data_pipeline.indicadores"
[0m22:00:23.049511 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.ativos
[0m22:00:23.055805 [debug] [Thread-2  ]: Began executing node model.financas_data_pipeline.indicadores
[0m22:00:23.106430 [debug] [Thread-2  ]: Writing runtime sql for node "model.financas_data_pipeline.indicadores"
[0m22:00:23.107947 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.ativos"
[0m22:00:23.112778 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.114129 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: BEGIN
[0m22:00:23.114732 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.115575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:23.116848 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: BEGIN
[0m22:00:23.119326 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:00:23.121272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m22:00:23.122653 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.124045 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */

  
    

  create  table "dw_nerds_prd"."prata"."ativos__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(open AS NUMERIC(15, 3)) AS preco_abertura,
        CAST(high AS NUMERIC(15, 3)) AS preco_alto,
        CAST(low AS NUMERIC(15, 3)) AS preco_baixo,
        CAST(close AS NUMERIC(15, 3)) AS preco_fechamento,
        CAST(volume AS BIGINT) AS volume_negociado,
        ticker AS ativo -- Renomeando ticker para ativo
    FROM "dw_nerds_prd"."bronze"."ativos"
    WHERE data IS NOT NULL
)

SELECT
    data,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    ativo -- Mantendo o nome correto como ativo
FROM ativos_limpos
  );
  
[0m22:00:23.126113 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m22:00:23.127157 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.128304 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */

  
    

  create  table "dw_nerds_prd"."prata"."indicadores__dbt_tmp"
  
  
    as
  
  (
    

WITH indicadores_limpos AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS valor_indicador,
        ticker AS ativo, -- Renomeando ticker para ativo
        indicador
    FROM "dw_nerds_prd"."bronze"."indicadores"
    WHERE data IS NOT NULL
      AND valor IS NOT NULL
)

SELECT
    data,
    valor_indicador,
    ativo, -- Mantendo o nome correto como ativo
    indicador
FROM indicadores_limpos
  );
  
[0m22:00:23.130749 [debug] [Thread-1  ]: SQL status: SELECT 400 in 0.004 seconds
[0m22:00:23.139859 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.140452 [debug] [Thread-2  ]: SQL status: SELECT 6312 in 0.011 seconds
[0m22:00:23.141238 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos" rename to "ativos__dbt_backup"
[0m22:00:23.144939 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.146309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.147072 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores" rename to "indicadores__dbt_backup"
[0m22:00:23.150655 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.151986 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.152550 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
alter table "dw_nerds_prd"."prata"."ativos__dbt_tmp" rename to "ativos"
[0m22:00:23.155776 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.156801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.157343 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
alter table "dw_nerds_prd"."prata"."indicadores__dbt_tmp" rename to "indicadores"
[0m22:00:23.175829 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m22:00:23.176649 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.177275 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.179309 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m22:00:23.180339 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: COMMIT
[0m22:00:23.181134 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.182381 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: COMMIT
[0m22:00:23.182738 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:00:23.184030 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m22:00:23.190285 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."ativos__dbt_backup"
[0m22:00:23.193708 [debug] [Thread-2  ]: Applying DROP to: "dw_nerds_prd"."prata"."indicadores__dbt_backup"
[0m22:00:23.198975 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.ativos"
[0m22:00:23.200410 [debug] [Thread-2  ]: Using ***** connection "model.financas_data_pipeline.indicadores"
[0m22:00:23.201423 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.ativos"} */
drop table if exists "dw_nerds_prd"."prata"."ativos__dbt_backup" cascade
[0m22:00:23.202232 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.indicadores"} */
drop table if exists "dw_nerds_prd"."prata"."indicadores__dbt_backup" cascade
[0m22:00:23.204763 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:23.205249 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m22:00:23.208080 [debug] [Thread-1  ]: On model.financas_data_pipeline.ativos: Close
[0m22:00:23.209881 [debug] [Thread-2  ]: On model.financas_data_pipeline.indicadores: Close
[0m22:00:23.211876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2602be850>]}
[0m22:00:23.212852 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25c6b9040>]}
[0m22:00:23.213780 [info ] [Thread-1  ]: 1 of 3 OK created sql table model prata.ativos ................................. [[32mSELECT 400[0m in 0.18s]
[0m22:00:23.214942 [info ] [Thread-2  ]: 2 of 3 OK created sql table model prata.indicadores ............................ [[32mSELECT 6312[0m in 0.18s]
[0m22:00:23.216146 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.ativos
[0m22:00:23.217161 [debug] [Thread-2  ]: Finished running node model.financas_data_pipeline.indicadores
[0m22:00:23.218048 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.tesouro
[0m22:00:23.219489 [info ] [Thread-1  ]: 3 of 3 START sql table model prata.tesouro ..................................... [RUN]
[0m22:00:23.220442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.financas_data_pipeline.ativos, now model.financas_data_pipeline.tesouro)
[0m22:00:23.221292 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.tesouro
[0m22:00:23.225731 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.tesouro"
[0m22:00:23.230810 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.tesouro
[0m22:00:23.235759 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.tesouro"
[0m22:00:23.244706 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.246080 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: BEGIN
[0m22:00:23.247264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:23.251422 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m22:00:23.252533 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.253505 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */

  
    

  create  table "dw_nerds_prd"."prata"."tesouro__dbt_tmp"
  
  
    as
  
  (
    

WITH tesouro_limpo AS (
    SELECT
        CAST(data AS DATE) AS data,
        CAST(valor AS NUMERIC(15, 3)) AS rendimento
    FROM "dw_nerds_prd"."bronze"."tesouro"
    WHERE data IS NOT NULL AND valor IS NOT NULL
)

SELECT
    data,
    rendimento
FROM tesouro_limpo
  );
  
[0m22:00:23.267745 [debug] [Thread-1  ]: SQL status: SELECT 12131 in 0.013 seconds
[0m22:00:23.271704 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.272867 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro" rename to "tesouro__dbt_backup"
[0m22:00:23.274122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.278202 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.279289 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
alter table "dw_nerds_prd"."prata"."tesouro__dbt_tmp" rename to "tesouro"
[0m22:00:23.280514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:23.282490 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m22:00:23.283674 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.284656 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: COMMIT
[0m22:00:23.288184 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m22:00:23.291841 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."prata"."tesouro__dbt_backup"
[0m22:00:23.293502 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.tesouro"
[0m22:00:23.294711 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.tesouro"} */
drop table if exists "dw_nerds_prd"."prata"."tesouro__dbt_backup" cascade
[0m22:00:23.296826 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:00:23.298938 [debug] [Thread-1  ]: On model.financas_data_pipeline.tesouro: Close
[0m22:00:23.300103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176521b1-51d2-42b0-ae5d-3461dc1cac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25c6b9040>]}
[0m22:00:23.301312 [info ] [Thread-1  ]: 3 of 3 OK created sql table model prata.tesouro ................................ [[32mSELECT 12131[0m in 0.08s]
[0m22:00:23.302445 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.tesouro
[0m22:00:23.304303 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:23.305232 [debug] [MainThread]: On master: BEGIN
[0m22:00:23.306124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:23.309551 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:00:23.310676 [debug] [MainThread]: On master: COMMIT
[0m22:00:23.311566 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:23.312547 [debug] [MainThread]: On master: COMMIT
[0m22:00:23.313571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:23.314401 [debug] [MainThread]: On master: Close
[0m22:00:23.315788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:23.317004 [debug] [MainThread]: Connection 'model.financas_data_pipeline.indicadores' was properly closed.
[0m22:00:23.317826 [debug] [MainThread]: Connection 'model.financas_data_pipeline.tesouro' was properly closed.
[0m22:00:23.319503 [info ] [MainThread]: 
[0m22:00:23.321768 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m22:00:23.323104 [debug] [MainThread]: Command end result
[0m22:00:23.369209 [info ] [MainThread]: 
[0m22:00:23.370335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:23.371219 [info ] [MainThread]: 
[0m22:00:23.372074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:00:23.373502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2815986, "process_user_time": 2.058581, "process_kernel_time": 0.132482, "process_mem_max_rss": "273764", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:23.374478 [debug] [MainThread]: Command `dbt run` succeeded at 22:00:23.374383 after 1.28 seconds
[0m22:00:23.375429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa260654040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25f028730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25db886a0>]}
[0m22:00:23.376745 [debug] [MainThread]: Flushing usage events
[0m22:00:26.039272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4391de040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43748d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43748d550>]}


============================== 22:00:26.047245 | ff5c0a3f-b31e-4a46-9127-30632e88c560 ==============================
[0m22:00:26.047245 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:00:26.048487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt --select ouro', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:00:26.196032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff436ade9a0>]}
[0m22:00:26.254227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43749d6d0>]}
[0m22:00:26.256229 [info ] [MainThread]: Registered adapter: *****=1.8.2
[0m22:00:26.339882 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:00:26.580538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:26.581770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:26.622518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4366ca130>]}
[0m22:00:26.740956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff436a0a490>]}
[0m22:00:26.742078 [info ] [MainThread]: Found 4 models, 6 sources, 429 macros
[0m22:00:26.743011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff436a0a520>]}
[0m22:00:26.744806 [info ] [MainThread]: 
[0m22:00:26.745947 [debug] [MainThread]: Acquiring new ***** connection 'master'
[0m22:00:26.747661 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd'
[0m22:00:26.812712 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd"
[0m22:00:26.813912 [debug] [ThreadPool]: On list_dw_nerds_prd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd"} */

    select distinct nspname from pg_namespace
  
[0m22:00:26.814814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:26.818552 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m22:00:26.820336 [debug] [ThreadPool]: On list_dw_nerds_prd: Close
[0m22:00:26.824992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dw_nerds_prd, now list_dw_nerds_prd_ouro)
[0m22:00:26.825609 [debug] [ThreadPool]: Acquiring new ***** connection 'list_dw_nerds_prd_prata'
[0m22:00:26.832635 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:00:26.834917 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:00:26.835904 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: BEGIN
[0m22:00:26.836979 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: BEGIN
[0m22:00:26.838075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:26.839160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:26.842614 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:00:26.843640 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_ouro"
[0m22:00:26.844450 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:00:26.844906 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_ouro"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'ouro'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'ouro'
  
[0m22:00:26.846370 [debug] [ThreadPool]: Using ***** connection "list_dw_nerds_prd_prata"
[0m22:00:26.847885 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "list_dw_nerds_prd_prata"} */
select
      'dw_nerds_prd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prata'
    union all
    select
      'dw_nerds_prd' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'prata'
  
[0m22:00:26.849012 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:00:26.850649 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: ROLLBACK
[0m22:00:26.851228 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m22:00:26.851838 [debug] [ThreadPool]: On list_dw_nerds_prd_ouro: Close
[0m22:00:26.853380 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: ROLLBACK
[0m22:00:26.855474 [debug] [ThreadPool]: On list_dw_nerds_prd_prata: Close
[0m22:00:26.861109 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:26.862074 [debug] [MainThread]: On master: BEGIN
[0m22:00:26.862883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:26.865821 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m22:00:26.867072 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:26.868079 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:00:26.871396 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m22:00:26.872921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff437442b80>]}
[0m22:00:26.873762 [debug] [MainThread]: On master: ROLLBACK
[0m22:00:26.874570 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:26.875246 [debug] [MainThread]: On master: BEGIN
[0m22:00:26.876193 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:00:26.876935 [debug] [MainThread]: On master: COMMIT
[0m22:00:26.877598 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:26.878299 [debug] [MainThread]: On master: COMMIT
[0m22:00:26.879172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:26.880016 [debug] [MainThread]: On master: Close
[0m22:00:26.880971 [info ] [MainThread]: Concurrency: 2 threads (target='prd')
[0m22:00:26.881953 [info ] [MainThread]: 
[0m22:00:26.891953 [debug] [Thread-1  ]: Began running node model.financas_data_pipeline.produto_dados_financeiros
[0m22:00:26.893073 [info ] [Thread-1  ]: 1 of 1 START sql table model ouro.produto_dados_financeiros .................... [RUN]
[0m22:00:26.894076 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dw_nerds_prd_prata, now model.financas_data_pipeline.produto_dados_financeiros)
[0m22:00:26.894940 [debug] [Thread-1  ]: Began compiling node model.financas_data_pipeline.produto_dados_financeiros
[0m22:00:26.906405 [debug] [Thread-1  ]: Writing injected SQL for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.912012 [debug] [Thread-1  ]: Began executing node model.financas_data_pipeline.produto_dados_financeiros
[0m22:00:26.952559 [debug] [Thread-1  ]: Writing runtime sql for node "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.958822 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.959781 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: BEGIN
[0m22:00:26.961098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:00:26.965413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m22:00:26.966929 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.968146 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */

  
    

  create  table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp"
  
  
    as
  
  (
    

WITH ativos_base AS (
    SELECT
        a.data,
        a.ativo,
        a.preco_abertura,
        a.preco_alto,
        a.preco_baixo,
        a.preco_fechamento,
        a.volume_negociado
    FROM "dw_nerds_prd"."prata"."ativos" a  -- Ref para a tabela `prata.ativos`
),

ativos_com_indicadores AS (
    SELECT
        ab.*,
        i.indicador,
        i.valor_indicador
    FROM ativos_base ab
    LEFT JOIN "dw_nerds_prd"."prata"."indicadores" i  -- Ref para a tabela `prata.indicadores`
    ON ab.data = i.data
    AND ab.ativo = i.ativo
),

ativos_com_tesouro AS (
    SELECT
        ai.*,
        t.rendimento AS rendimento_tesouro
    FROM ativos_com_indicadores ai
    LEFT JOIN "dw_nerds_prd"."prata"."tesouro" t  -- Ref para a tabela `prata.tesouro`
    ON ai.data = t.data
)

SELECT
    data,
    ativo,
    preco_abertura,
    preco_alto,
    preco_baixo,
    preco_fechamento,
    volume_negociado,
    indicador,
    valor_indicador,
    rendimento_tesouro
FROM ativos_com_tesouro
  );
  
[0m22:00:26.979168 [debug] [Thread-1  ]: SQL status: SELECT 400 in 0.010 seconds
[0m22:00:26.985556 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.986484 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros" rename to "produto_dados_financeiros__dbt_backup"
[0m22:00:26.987731 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:26.991062 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:26.992089 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
alter table "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_tmp" rename to "produto_dados_financeiros"
[0m22:00:26.993392 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:00:27.013296 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m22:00:27.014927 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:27.015974 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: COMMIT
[0m22:00:27.017830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m22:00:27.025081 [debug] [Thread-1  ]: Applying DROP to: "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup"
[0m22:00:27.030785 [debug] [Thread-1  ]: Using ***** connection "model.financas_data_pipeline.produto_dados_financeiros"
[0m22:00:27.032186 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "financas_data", "target_name": "prd", "node_id": "model.financas_data_pipeline.produto_dados_financeiros"} */
drop table if exists "dw_nerds_prd"."ouro"."produto_dados_financeiros__dbt_backup" cascade
[0m22:00:27.034506 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m22:00:27.037328 [debug] [Thread-1  ]: On model.financas_data_pipeline.produto_dados_financeiros: Close
[0m22:00:27.039215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff5c0a3f-b31e-4a46-9127-30632e88c560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff438e49850>]}
[0m22:00:27.040840 [info ] [Thread-1  ]: 1 of 1 OK created sql table model ouro.produto_dados_financeiros ............... [[32mSELECT 400[0m in 0.14s]
[0m22:00:27.042185 [debug] [Thread-1  ]: Finished running node model.financas_data_pipeline.produto_dados_financeiros
[0m22:00:27.044034 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:27.044843 [debug] [MainThread]: On master: BEGIN
[0m22:00:27.045620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:27.049970 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:00:27.050920 [debug] [MainThread]: On master: COMMIT
[0m22:00:27.051878 [debug] [MainThread]: Using ***** connection "master"
[0m22:00:27.052710 [debug] [MainThread]: On master: COMMIT
[0m22:00:27.053658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:00:27.054448 [debug] [MainThread]: On master: Close
[0m22:00:27.055521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:27.056339 [debug] [MainThread]: Connection 'list_dw_nerds_prd_ouro' was properly closed.
[0m22:00:27.057111 [debug] [MainThread]: Connection 'model.financas_data_pipeline.produto_dados_financeiros' was properly closed.
[0m22:00:27.057943 [info ] [MainThread]: 
[0m22:00:27.058849 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m22:00:27.060116 [debug] [MainThread]: Command end result
[0m22:00:27.103504 [info ] [MainThread]: 
[0m22:00:27.104842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:27.105858 [info ] [MainThread]: 
[0m22:00:27.106862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:00:27.108608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1328996, "process_user_time": 1.889742, "process_kernel_time": 0.129298, "process_mem_max_rss": "273772", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:00:27.109690 [debug] [MainThread]: Command `dbt run` succeeded at 22:00:27.109597 after 1.13 seconds
[0m22:00:27.110599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4391de040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff437b3a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff436a2a0a0>]}
[0m22:00:27.111462 [debug] [MainThread]: Flushing usage events
